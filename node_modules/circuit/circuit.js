var window=window||null,Circuit=function(a){"use strict";var b={name:"unknown"};return"undefined"!=typeof process?process.versions&&process.versions.node?b={name:"node",version:process.versions.node,hostname:require("os").hostname()}:process.argv&&process.argv[0]&&(b={name:process.argv[0]}):b={name:"browser"},window||(window={setTimeout:setTimeout,clearTimeout:clearTimeout,setInterval:setInterval,clearInterval:clearInterval,location:{host:b.hostname},navigator:{platform:b.name}}),a._runtime=b,a}(Circuit||{});Array.prototype.find||(Array.prototype.find=function(a){"use strict";if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof a)throw new TypeError("predicate must be a function");for(var b,c=Object(this),d=c.length>>>0,e=arguments[1],f=0;d>f;f++)if(b=c[f],a.call(e,b,f,c))return b;return void 0});var Circuit=function(a){"use strict";var b={setLevel:function(){},getLevel:function(){},debug:function(){console.log.apply(console,Array.prototype.slice.apply(arguments))},info:function(){console.info.apply(console,Array.prototype.slice.apply(arguments))},warning:function(){console.warn.apply(console,Array.prototype.slice.apply(arguments))},warn:function(){console.warn.apply(console,Array.prototype.slice.apply(arguments))},error:function(a,b){a=a&&a.stack||a,b=b&&b.stack||b,b?console.error(a,b):console.error(a)},msgSend:function(){console.log.apply(console,Array.prototype.slice.apply(arguments))},msgRcvd:function(){console.log.apply(console,Array.prototype.slice.apply(arguments))}};return a.logger=b,a}(Circuit||{}),Circuit=function(a){"use strict";var b=function(){function a(a,b){var c=p[b];return c?String.fromCodePoint(c):""}function c(a,b){return Math.floor(Math.random()*(b-a+1))+a}function d(a){return a}function e(a){return 0===Object.keys(a).length}function f(b){return b.replace(n,a)}function g(){if(!navigator)return{};if("iOS"===navigator.platform)return{ios:!0,type:"ios"};if("Android"===navigator.platform)return{android:!0,type:"android"};var a={},b=navigator.userAgent.toLowerCase(),c=/(msie|trident)(?: |.*rv:)([\d.]+)/.exec(b)||/(opera|opr)(?:.*version|)\/([\d.]+)/.exec(b)||/(firefox)\/([\d.]+)/.exec(b)||/version\/([\d.]+).*(safari)/.exec(b)||/(chrome)\/([\d.]+)/.exec(b)||[],d=c[1]||"",e=c[2]||0;return"safari"===e?(d=c[2],e=c[1]):"trident"===d?d="msie":"opr"===d&&(d="opera"),a[d]=!0,a.type=d,a.version=e,a}function h(a){var b=/^image\/(jpeg|gif|bmp|png)$/i;return b.test(a)}function i(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.parent=b.prototype}function j(a,b){if(!a)return"";var c=b?"&nbsp;":"<br>";return a.replace(/&/g,"&amp;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n|\r|\n/gm,c)}function k(a){return a?a.replace(/&amp;/g,"&").replace(/&#34;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/<br\/?>/g,"\r\n"):""}function l(a){if(!a||"object"!=typeof a)return a;var c=Object.getPrototypeOf(a);if(b.isEmptyObject(c))return a;var d={};for(var e in a)"function"!=typeof a[e]&&(d[e]=a[e]);return d}function m(a){if(!a||"object"!=typeof a)return a;if(Array.isArray(a))return a.slice();var b=l(a),c={};for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c}var n=/<img[^>|<]*(?:shortcut|abbr)="(\S*)"[^\/?>]*\/?>/gi,o=/^[_a-z0-9-]+(?:\.[_a-z0-9-]+)*@[a-z0-9-]+(?:\.[a-z0-9-]+)*(?:\.[a-z][a-z]+)$/im,p={":)":128515,":D":128516,":(":128542,":heart":128525,";)":128521,":awesome":128516,":angry":128544,":zzz":128554,":O":128562,";(":128546};return{EMOTICON_MAPPING:p,EMAIL_ADDRESS_PATTERN:o,randomNumber:c,sanitize:d,isEmptyObject:e,standardizeEmoticon:f,isSupportedImage:h,getBrowserInfo:g,inherit:i,textToHtmlEscaped:j,escapedHtmlToText:k,shallowCopy:m}}();return a.Utils=b,a}(Circuit||{}),Circuit=function(a){"use strict";var b={},c=null;try{c=window.localStorage||c}catch(d){c=window.sessionStorage||c}return b={getItem:function(a){return c?c.getItem(a):null},setItem:function(a,b){return c?c.setItem(a,b):null},removeItem:function(a){return c?c.removeItem(a):null}},a.storeManager=b,a}(Circuit||{}),Circuit=function(a){"use strict";var b=a.logger,c=a.Utils,d=Object.freeze({WSMessageType:{REQUEST:"REQUEST",RESPONSE:"RESPONSE",EVENT:"EVENT"},ContentType:{NONE:"NONE",EXTENSION:"EXTENSION",CONVERSATION:"CONVERSATION",USER:"USER",RTC_SESSION:"RTC_SESSION",RTC_CALL:"RTC_CALL",SEARCH:"SEARCH",KEEPALIVE:"KEEPALIVE",INSTRUMENTATION:"INSTRUMENTATION",GUEST:"GUEST",SYSTEM:"SYSTEM",ADMINISTRATION:"ADMINISTRATION",THIRDPARTYCONNECTORS:"THIRDPARTYCONNECTORS",USER_TO_USER:"USER_TO_USER"},ReturnCode:{OK:"OK",AUTHORIZATION_FAILED:"AUTHORIZATION_FAILED",AUTHORIZATION_REQUIRED:"AUTHORIZATION_REQUIRED",SERVICE_EXCEPTION:"SERVICE_EXCEPTION",PROTOBUF_CONVERSION_EXCEPTION:"PROTOBUF_CONVERSION_EXCEPTION",NO_MESSAGE_HANDLER:"NO_MESSAGE_HANDLER",INVALID_CLIENT:"INVALID_CLIENT",NO_RESULT:"NO_RESULT",OPERATION_NOT_SUPPORTED:"OPERATION_NOT_SUPPORTED",ENTITY_ALREADY_EXISTS:"ENTITY_ALREADY_EXISTS",FRAME_SIZE_TO_LONG:"FRAME_SIZE_TO_LONG",BACKEND_UNAVAILABLE:"BACKEND_UNAVAILABLE",OVERLOADED:"OVERLOADED",OLD_VERSION:"OLD_VERSION",STORAGE_OVERLOADED:"STORAGE_OVERLOADED",SERVICE_NOT_AVAILABLE:"SERVICE_NOT_AVAILABLE",REQUEST_TIMEOUT:"REQUEST_TIMEOUT",DISCONNECTED:"DISCONNECTED",INVALID_MESSAGE:"INVALID_MESSAGE",FAILED_TO_SEND:"FAILED_TO_SEND",UNEXPECTED_RESPONSE:"UNEXPECTED_RESPONSE"},ErrorCode:{UNEXPECTED_ERROR:"UNEXPECTED_ERROR",CONSTRAINT_VIOLATION:"CONSTRAINT_VIOLATION",MAX_NUM_CONV_PARTICIPANTS:"MAX_NUM_CONV_PARTICIPANTS",THIRDPARTY_ERROR:"THIRDPARTY_ERROR"},ThirdPartyError:{UNSUPPORTED_PROVIDER:"UNSUPPORTED_PROVIDER",BAD_REQUEST:"BAD_REQUEST",GENERAL_ERROR:"GENERAL_ERROR",INSUFFICIENT_PERMISSION:"INSUFFICIENT_PERMISSION",NOT_AUTHORIZED:"NOT_AUTHORIZED",RESOURCE_NOT_FOUND:"RESOURCE_NOT_FOUND",SERVER_DOWN:"SERVER_DOWN",SESSION_EXPIRED:"SESSION_EXPIRED",UNSUPPORTED_FILE_TYPE:"UNSUPPORTED_FILE_TYPE",WRONG_SERVER:"WRONG_SERVER",EMPTY_SETTINGS:"EMPTY_SETTINGS",EMPTY_USERNAME:"EMPTY_USERNAME",EMPTY_PASSWORD:"EMPTY_PASSWORD",EMPTY_SERVER_ADDRESS:"EMPTY_SERVER_ADDRESS",INVALID_SERVER_ADDRESS:"INVALID_SERVER_ADDRESS",NOT_CONNECTED:"NOT_CONNECTED"},ConversationActionType:{CREATE:"CREATE",DELETE:"DELETE",ADD_PARTICIPANT:"ADD_PARTICIPANT",REMOVE_PARTICIPANT:"REMOVE_PARTICIPANT",UPDATE:"UPDATE",ADD_TEXT_ITEM:"ADD_TEXT_ITEM",UPDATE_TEXT_ITEM:"UPDATE_TEXT_ITEM",DELETE_TEXT_ITEM:"DELETE_TEXT_ITEM",ADD_SCHEDULE_ITEM:"ADD_SCHEDULE_ITEM",UPDATE_SCHEDULE_ITEM:"UPDATE_SCHEDULE_ITEM",DELETE_SCHEDULE_ITEM:"DELETE_SCHEDULE_ITEM",GET_CONVERSATION_BY_ID:"GET_CONVERSATION_BY_ID",GET_CONVERSATIONS:"GET_CONVERSATIONS",GET_CONVERSATION_THREADS:"GET_CONVERSATION_THREADS",GET_THREAD_COMMENTS:"GET_THREAD_COMMENTS",GET_ITEM_BY_ID:"GET_ITEM_BY_ID",GET_ITEMS_BY_CONVERSATION:"GET_ITEMS_BY_CONVERSATION",GET_ITEMS_BY_THREAD:"GET_ITEMS_BY_THREAD",SET_READ_POINTER:"SET_READ_POINTER",SUBSCRIBE:"SUBSCRIBE",UNSUBSCRIBE:"UNSUBSCRIBE",TYPING:"TYPING",GET_ITEMS_BY_CONVERSATION_ITEM_ID:"GET_ITEMS_BY_CONVERSATION_ITEM_ID",GET_CONVERSATION_USER_DATA:"GET_CONVERSATION_USER_DATA",SET_FLAG_ITEM:"SET_FLAG_ITEM",CLEAR_FLAG_ITEM:"CLEAR_FLAG_ITEM",GET_FLAGGED_ITEMS:"GET_FLAGGED_ITEMS",GET_JOIN_DETAILS:"GET_JOIN_DETAILS",GET_SUPPORT_CONVERSATION:"GET_SUPPORT_CONVERSATION",GET_SUPPORT_CONVERSATION_ID:"GET_SUPPORT_CONVERSATION_ID",GET_OPEN_CONVERSATIONS:"GET_OPEN_CONVERSATIONS",JOIN_OPEN_CONVERSATION:"JOIN_OPEN_CONVERSATION",MARK_CONVERSATION:"MARK_CONVERSATION",UNMARK_CONVERSATION:"UNMARK_CONVERSATION",GET_MARKED_CONVERSATIONS_LIST:"GET_MARKED_CONVERSATIONS_LIST",GET_TELEPHONY_CONVERSATION_ID:"GET_TELEPHONY_CONVERSATION_ID",SET_CONVERSATION_AVATAR:"SET_CONVERSATION_AVATAR",GET_CONVERSATION_BY_USER:"GET_CONVERSATION_BY_USER",GET_CONVERSATION_SUMMARY:"GET_CONVERSATION_SUMMARY",LIKE_TEXT_ITEM:"LIKE_TEXT_ITEM",UNLIKE_TEXT_ITEM:"UNLIKE_TEXT_ITEM",DELETE_RECORDING:"DELETE_RECORDING",MODERATE_CONVERSATION:"MODERATE_CONVERSATION",UNMODERATE_CONVERSATION:"UNMODERATE_CONVERSATION",GET_ALL_USER_SCHEDULE_ITEMS:"GET_ALL_USER_SCHEDULE_ITEMS",GRANT_MODERATOR_RIGHTS:"GRANT_MODERATOR_RIGHTS",DROP_MODERATOR_RIGHTS:"DROP_MODERATOR_RIGHTS"},ConversationEventType:{CREATE:"CREATE",UPDATE:"UPDATE",DELETE:"DELETE",ADD_ITEM:"ADD_ITEM",UPDATE_ITEM:"UPDATE_ITEM",READ_ITEMS:"READ_ITEMS",TYPING:"TYPING",DRAFT_MESSAGE_SAVED:"DRAFT_MESSAGE_SAVED",DRAFT_MESSAGE_DISCARDED:"DRAFT_MESSAGE_DISCARDED",DRAFT_MESSAGE_PUBLISHED:"DRAFT_MESSAGE_PUBLISHED",FLAG_ITEM:"FLAG_ITEM",CLEAR_FLAGGED_ITEM:"CLEAR_FLAGGED_ITEM",CONVERSATION_MARKED:"CONVERSATION_MARKED",CONVERSATION_UNMARKED:"CONVERSATION_UNMARKED"},SearchDirection:{AFTER:"AFTER",BEFORE:"BEFORE",BOTH:"BOTH"},OrderType:{MODIFICATION:"MODIFICATION",CREATION:"CREATION"},ConversationType:{DIRECT:"DIRECT",GROUP:"GROUP",OPEN:"OPEN"},ConversationItemType:{TEXT:"TEXT",RTC:"RTC",SCHEDULE:"SCHEDULE",SYSTEM:"SYSTEM"},ConversationFilter:{ALL:"ALL",OPEN_MEMBER:"OPEN_MEMBER",MARKED:"MARKED"},ConversationMarkFilter:{MUTE:"MUTE",FAVORITE:"FAVORITE"},RTCItemType:{STARTED:"STARTED",ENDED:"ENDED",MISSED:"MISSED",PARTICIPANT_JOINED:"PARTICIPANT_JOINED",PARTICIPANT_LEFT:"PARTICIPANT_LEFT",MOVED:"MOVED"},RTCItemMissed:{UNREACHABLE:"UNREACHABLE",TIMEOUT:"TIMEOUT",USER_BUSY:"USER_BUSY",DECLINED:"DECLINED",CANCELED:"CANCELED",INVALID_NUMBER:"INVALID_NUMBER",TEMPORARILY_UNAVAILABLE:"TEMPORARILY_UNAVAILABLE"},RTCItemMoved:{MOVED_FROM:"MOVED_FROM",MOVED_TO:"MOVED_TO"},SortingType:{RECENT_ACTIVITY_ASC:"RECENT_ACTIVITY_ASC",RECENT_ACTIVITY_DESC:"RECENT_ACTIVITY_DESC",ALPHABETICALLY_ASC:"ALPHABETICALLY_ASC",ALPHABETICALLY_DESC:"ALPHABETICALLY_DESC",POPULARITY_ASC:"POPULARITY_ASC",POPULARITY_DESC:"POPULARITY_DESC"},TextItemContentType:{PLAIN:"PLAIN",RICH:"RICH"},TextItemState:{CREATED:"CREATED",EDITED:"EDITED",DELETED:"DELETED",CLUSTERED:"CLUSTERED"},SystemItemType:{CONVERSATION_CREATED:"CONVERSATION_CREATED",PARTICIPANT_ADDED:"PARTICIPANT_ADDED",PARTICIPANT_REMOVED:"PARTICIPANT_REMOVED",CONVERSATION_RENAMED:"CONVERSATION_RENAMED",GUEST_JOINED:"GUEST_JOINED",GUEST_INVITED:"GUEST_INVITED",CONFERENCE_DETAILS_CHANGED:"CONFERENCE_DETAILS_CHANGED",CONVERSATION_MODERATED:"CONVERSATION_MODERATED"},ScheduleItemState:{ACTIVE:"ACTIVE",EXPIRED:"EXPIRED",CANCELED:"CANCELLED"},InstrumentationActionType:{SUBMIT_CLIENT_DATA:"SUBMIT_CLIENT_DATA",SUBMIT_QOS_DATA:"SUBMIT_QOS_DATA"},SubmitDataResult:{UNKNOWN:"UNKNOWN",OK:"OK",NO_USERID:"NO_USERID",NO_CLIENTID:"NO_CLIENTID",NO_DATA:"NO_DATA",PROCESSING_ERROR:"PROCESSING_ERROR"},QOSMediaType:{AUDIO:"AUDIO",VIDEO:"VIDEO",SCREEN_SHARE:"SCREEN_SHARE"},RTCCallActionType:{JOIN:"JOIN",ANSWER:"ANSWER",LEAVE:"LEAVE",TERMINATE:"TERMINATE",CHANGE_MEDIA_TYPE:"CHANGE_MEDIA_TYPE",INVITE_REJECT:"INVITE_REJECT",CHANGE_MEDIA_ACCEPT:"CHANGE_MEDIA_ACCEPT",CHANGE_MEDIA_REJECT:"CHANGE_MEDIA_REJECT",PREPARE:"PREPARE",RENEW_TURN_CREDENTIALS:"RENEW_TURN_CREDENTIALS"},RTCCallEventType:{SDP_ANSWER:"SDP_ANSWER",SDP_FAILED:"SDP_FAILED",INVITE:"INVITE",INVITE_CANCEL:"INVITE_CANCEL",INVITE_FAILED:"INVITE_FAILED",CHANGE_MEDIA_TYPE_REQUESTED:"CHANGE_MEDIA_TYPE_REQUESTED"},SdpFailedCause:{SESSION_STARTED_FAILED:"SESSION_STARTED_FAILED",CONNECTION_LOST:"CONNECTION_LOST",SERVICE_ERROR:"SERVICE_ERROR",CHANGE_MEDIA_REJECT:"CHANGE_MEDIA_REJECT"},InviteCancelCause:{ACCEPT:"ACCEPT",BUSY:"BUSY",DECLINE:"DECLINE"},InviteFailedCause:{BUSY:"BUSY",DECLINE:"DECLINE",TIMEOUT:"TIMEOUT",NOT_REACHABLE:"NOT_REACHABLE",INVALID_NUMBER:"INVALID_NUMBER",TEMPORARILY_UNAVAILABLE:"TEMPORARILY_UNAVAILABLE"},InviteRejectCause:{BUSY:"BUSY",DECLINE:"DECLINE",TIMEOUT:"TIMEOUT"},RTCSessionActionType:{LOCK:"LOCK",MUTE_SESSION:"MUTE_SESSION",MUTE:"MUTE",ADD_PARTICIPANT:"ADD_PARTICIPANT",REMOVE_PARTICIPANT:"REMOVE_PARTICIPANT",GET_ACTIVE_SESSIONS:"GET_ACTIVE_SESSIONS",GET_SESSION:"GET_SESSION",MOVE:"MOVE",START_RECORDING:"START_RECORDING",STOP_RECORDING:"STOP_RECORDING"},RTCSessionEventType:{SESSION_STARTED:"SESSION_STARTED",SESSION_TERMINATED:"SESSION_TERMINATED",SESSION_UPDATED:"SESSION_UPDATED",SESSION_MOVED:"SESSION_MOVED",PARTICIPANT_JOINED:"PARTICIPANT_JOINED",PARTICIPANT_LEFT:"PARTICIPANT_LEFT",PARTICIPANT_UPDATED:"PARTICIPANT_UPDATED",ACTIVE_SPEAKER:"ACTIVE_SPEAKER",VIDEO_ACTIVE_SPEAKER:"VIDEO_ACTIVE_SPEAKER",SESSION_RECORDING_STARTED:"SESSION_RECORDING_STARTED",SESSION_RECORDING_STOPPED:"SESSION_RECORDING_STOPPED",SESSION_RECORDING_FAILED:"SESSION_RECORDING_FAILED"},RTCSessionTerminatedCause:{FORCED:"FORCED",NO_USERS_LEFT:"NO_USERS_LEFT"},RTCSessionParticipantLeftCause:{LEFT:"LEFT",CONNECTION_LOST:"CONNECTION_LOST",REMOVED:"REMOVED"},RealtimeMediaType:{AUDIO:"AUDIO",VIDEO:"VIDEO",DESKTOP_SHARING:"DESKTOP_SHARING"},RTCParticipantType:{USER:"USER",EXTERNAL:"EXTERNAL",TELEPHONY:"TELEPHONY",SESSION_GUEST:"SESSION_GUEST",MEETING_POINT:"MEETING_POINT"},SearchActionType:{START_BASIC_SEARCH:"START_BASIC_SEARCH",START_DETAIL_SEARCH:"START_DETAIL_SEARCH",START_USER_SEARCH:"START_USER_SEARCH",CANCEL_SEARCH:"CANCEL_SEARCH",ADD_RECENT_SEARCH:"ADD_RECENT_SEARCH",GET_RECENT_SEARCHES:"GET_RECENT_SEARCHES"},SearchEventType:{BASIC_SEARCH_RESULT:"BASIC_SEARCH_RESULT",DETAILED_SEARCH_RESULT:"DETAILED_SEARCH_RESULT",SEARCH_STATUS:"SEARCH_STATUS",RECENT_SEARCH_ADDED:"RECENT_SEARCH_ADDED"},SystemActionType:{GET_GLOBAL_PROPERTY:"GET_GLOBAL_PROPERTY",GET_GLOBAL_PROPERTIES:"GET_GLOBAL_PROPERTIES"},SystemEventType:{MAINTENANCE:"MAINTENANCE",CLIENT_UPDATE:"CLIENT_UPDATE"},GlobalPropertyName:{ATTACHMENT_UPLOAD_MAX_SIZE:"ATTACHMENT_UPLOAD_MAX_SIZE",CONV_PARTICIPANTS_MAX_SIZE:"CONV_PARTICIPANTS_MAX_SIZE",CONV_PARTICIPANTS_ADD_LIMIT:"CONV_PARTICIPANTS_ADD_LIMIT"},SearchTypes:{CONVERSATION:"CONVERSATION",USER:"USER"},SearchStatusCode:{ERROR:"ERROR",CANCELED:"CANCELED",FINISHED:"FINISHED",TIMEOUT:"TIMEOUT",NO_RESULT:"NO_RESULT",MORE_RESULT:"MORE_RESULT"},SearchResultType:{TOPIC_MATCH:"TOPIC_MATCH",USER_MATCH:"USER_MATCH",ATTACHMENT_MATCH:"ATTACHMENT_MATCH",ITEM_MATCH:"ITEM_MATCH"},SearchScope:{ALL:"ALL",PEOPLE:"PEOPLE",MEMBERS:"MEMBERS",MESSAGES:"MESSAGES",CONVERSATIONS:"CONVERSATIONS",FILES:"FILES",SENT_BY:"SENT_BY",DATE:"DATE",DIAL:"DIAL"},UserActionType:{WAKE_UP:"WAKE_UP",GO_TO_SLEEP:"GO_TO_SLEEP",LOGON:"LOGON",LOGOUT:"LOGOUT",RENEW_TOKEN:"RENEW_TOKEN",GET_USER_BY_ID:"GET_USER_BY_ID",GET_USER_BY_NAME:"GET_USER_BY_NAME",UPDATE:"UPDATE",GET_LOGGED_ON:"GET_LOGGED_ON",SET_PRESENCE:"SET_PRESENCE",GET_PRESENCE:"GET_PRESENCE",SUBSCRIBE_PRESENCE:"SUBSCRIBE_PRESENCE",UNSUBSCRIBE_PRESENCE:"UNSUBSCRIBE_PRESENCE",CHANGE_PASSWORD:"CHANGE_PASSWORD",GET_USERS_BY_IDS:"GET_USERS_BY_IDS",GET_USER_SETTINGS:"GET_USER_SETTINGS",SET_USER_SETTINGS:"SET_USER_SETTINGS",GET_USER_BY_MAIL:"GET_USER_BY_MAIL",GET_USERS_BY_MAILS:"GET_USERS_BY_MAILS",EMAIL_UPDATE:"EMAIL_UPDATE",GENERATE_EMAIL_UPDATE_TOKEN:"GENERATE_EMAIL_UPDATE_TOKEN",GET_TELEPHONY_DATA:"GET_TELEPHONY_DATA",GET_USER_EXTENSIONS:"GET_USER_EXTENSIONS",SET_USER_EXTENSION_STATE:"SET_USER_EXTENSION_STATE",GET_LDAP_TECHNICAL_USER_PRESENCE:"GET_LDAP_TECHNICAL_USER_PRESENCE"},UserEventType:{USER_PRESENCE_CHANGE:"USER_PRESENCE_CHANGE",USER_UPDATED:"USER_UPDATED",SESSION_EXPIRES:"SESSION_EXPIRES",SESSION_CLOSED:"SESSION_CLOSED",PASSWORD_CHANGED:"PASSWORD_CHANGED",USER_SETTING_UPDATED:"USER_SETTING_UPDATED",TELEPHONY_DATA:"TELEPHONY_DATA"},PresenceState:{AVAILABLE:"AVAILABLE",OFFLINE:"OFFLINE",AWAY:"AWAY",BUSY:"BUSY",DND:"DND"},ChangePasswordResult:{OK:"OK",NEW_INVALID:"NEW_INVALID",OLD_INVALID:"OLD_INVALID",ALREADY_CHANGED:"ALREADY_CHANGED",OPERATION_ERROR:"OPERATION_ERROR"},SessionClosedReason:{NEW_CONNECTION_DETECTED:"NEW_CONNECTION_DETECTED",UPGRADE_REQUIRED:"UPGRADE_REQUIRED",SUSPENDED:"SUSPENDED",DELETED:"DELETED",TENANT_DELETED:"TENANT_DELETED",TENANT_SUSPENDED:"TENANT_SUSPENDED"},RecordingStoppedReason:{LENGTH_LIMIT_REACHED:"LENGTH_LIMIT_REACHED",NO_INPUT:"NO_INPUT"},UserRole:{GUEST:"GUEST",USER:"USER",TENANT_ADMIN:"TENANT_ADMIN",SUPPORT:"SUPPORT",SYSTEM_ADMIN:"SYSTEM_ADMIN",TELEPHONY_CONNECTOR:"TELEPHONY_CONNECTOR",VIRTUAL_TELEPHONY_CONNECTOR:"VIRTUAL_TELEPHONY_CONNECTOR",SESSION_GUEST:"SESSION_GUEST",MEETING_POINT:"MEETING_POINT"},UserState:{INACTIVE:"INACTIVE",ACTIVE:"ACTIVE",SUSPENDED:"SUSPENDED",DELETED:"DELETED"},Locale:{EN_US:"EN_US",DE_DE:"DE_DE",FR_FR:"FR_FR",ES_ES:"ES_ES"},PhoneNumberType:{WORK:"WORK",MOBILE:"MOBILE",HOME:"HOME",FAX:"FAX",OTHER:"OTHER"},EmailAddressType:{WORK:"WORK",HOME:"HOME",OTHER:"OTHER"},UserSettingArea:{ALL:"ALL",EMAIL:"EMAIL",DESKTOP:"DESKTOP",PRIVACY:"PRIVACY",CLIENT:"CLIENT"},UserSettingDataType:{BOOLEAN:"BOOLEAN",NUMBER:"NUMBER",STRING:"STRING",TIMESTAMP:"TIMESTAMP"},UserSettingKey:{EMAIL_INVITES:"EMAIL_INVITES",EMAIL_MISSED_RTC:"EMAIL_MISSED_RTC",EMAIL_SUMMARY:"EMAIL_SUMMARY",EMAIL_UPDATE:"EMAIL_UPDATE",DESKTOP_RTC:"DESKTOP_RTC",DESKTOP_MISSED_MESSAGE:"DESKTOP_MISSED_MESSAGE",DESKTOP_CONVERSATION_CHANGE:"DESKTOP_CONVERSATION_CHANGE",DESKTOP_SYSINFO:"DESKTOP_SYSINFO",SHARE_LOCATION:"SHARE_LOCATION",RELEASE_NOTES_WEB_VERSION:"RELEASE_NOTES_WEB_VERSION",RELEASE_NOTES_MOBILE_VERSION:"RELEASE_NOTES_MOBILE_VERSION",TM_WEB_OPEN_CONVERSATION:"TM_WEB_OPEN_CONVERSATION",TM_WEB_START_CONV_WITH:"TM_WEB_START_CONV_WITH",TM_WEB_ENTER_NAME:"TM_WEB_ENTER_NAME",TM_WEB_INVITE_USERS:"TM_WEB_INVITE_USERS",TM_WEB_ADD_CONVERSATION_TITLE:"TM_WEB_ADD_CONVERSATION_TITLE",TM_WEB_MUTE_CONVERSATION:"TM_WEB_MUTE_CONVERSATION",TM_WEB_VIEW_MUTED_CONVERSATIONS:"TM_WEB_VIEW_MUTED_CONVERSATIONS",TM_WEB_LEAVING_CONVERSATION:"TM_WEB_LEAVING_CONVERSATION",TM_WEB_FOCUS_MODE:"TM_WEB_FOCUS_MODE",TM_WEB_REMOVING_PARTICIPANTS:"TM_WEB_REMOVING_PARTICIPANTS",TM_WEB_ADD_MULTIPLE_USERS:"TM_WEB_ADD_MULTIPLE_USERS",TM_WEB_SEARCH_FILTER:"TM_WEB_SEARCH_FILTER",TM_WEB_RESERVE_1:"TM_WEB_RESERVE_1",TM_WEB_RESERVE_2:"TM_WEB_RESERVE_2",TM_WEB_THIRD_COLUMN:"TM_WEB_THIRD_COLUMN",TM_WEB_SUPPORT_FEEDBACK:"TM_WEB_SUPPORT_FEEDBACK",TM_WEB_SUPPORT_ISSUE:"TM_WEB_SUPPORT_ISSUE",TM_WEB_SCREEN_SHARING_ENABLED:"TM_WEB_SCREEN_SHARING_ENABLED",AUDIO_WEB_SOUNDS:"AUDIO_WEB_SOUNDS",TM_WEB_ADMIN_TELEPHONY_ENABLED:"TM_WEB_ADMIN_TELEPHONY_ENABLED",TM_WEB_TELPHONY_NUMBER_ASSIGNED:"TM_WEB_TELPHONY_NUMBER_ASSIGNED",TM_WEB_ACTIVE_SPEAKER_VIDEO:"TM_WEB_ACTIVE_SPEAKER_VIDEO",TM_WEB_FIRST_DIRECT_CONVERSATION:"TM_WEB_FIRST_DIRECT_CONVERSATION",TM_WEB_FIRST_GROUP_CONVERSATION:"TM_WEB_FIRST_GROUP_CONVERSATION",TM_WEB_EMERGENCY_CALL_DISCLAIMER:"TM_WEB_EMERGENCY_CALL_DISCLAIMER",TM_WEB_FIRST_CONV_ADD_PARTCPNTS:"TM_WEB_FIRST_CONV_ADD_PARTCPNTS",TM_WEB_FIRST_CONV_SET_NAME:"TM_WEB_FIRST_CONV_SET_NAME",TM_WEB_FIRST_CONV_START_CONV:"TM_WEB_FIRST_CONV_START_CONV",TM_WEB_FIRST_DIRECT_PRIVATE_CONV:"TM_WEB_FIRST_DIRECT_PRIVATE_CONV",TM_WEB_FIRST_DIRECT_CONV_SAY_HI:"TM_WEB_FIRST_DIRECT_CONV_SAY_HI",TM_WEB_FIRST_DIRECT_CONV_ADD:"TM_WEB_FIRST_DIRECT_CONV_ADD",TM_WEB_GUEST_ACCESS:"TM_WEB_GUEST_ACCESS",TM_WEB_SHARE_CONFERENCE_DETAILS:"TM_WEB_SHARE_CONFERENCE_DETAILS",TM_WEB_START_RECORDING:"TM_WEB_START_RECORDING",TM_WEB_STOP_RECORDING_INIT:"TM_WEB_STOP_RECORDING_INIT",TM_WEB_STOP_RECORDING_PART:"TM_WEB_STOP_RECORDING_PART",TM_WEB_FIRST_CONF_RING_ALL:"TM_WEB_FIRST_CONF_RING_ALL",TM_WEB_FIRST_CALL_ACTIONS:"TM_WEB_FIRST_CALL_ACTIONS",TM_WEB_FIRST_CALL_GO_TO_FEED:"TM_WEB_FIRST_CALL_GO_TO_FEED",TM_WEB_FIRST_CALL_FULLSCREEN:"TM_WEB_FIRST_CALL_FULLSCREEN",FIRST_WEB_LOGIN_TIMESTAMP:"FIRST_WEB_LOGIN_TIMESTAMP"},ThirdpartyConnectionActionType:{SEND_AUTH_CODE:"SEND_AUTH_CODE",CONNECT:"CONNECT",DISCONNECT:"DISCONNECT",GET_CONNECTION_STATUS:"GET_CONNECTION_STATUS",GET_BOX_FOLDER_ITEMS:"GET_BOX_FOLDER_ITEMS",GET_FOLDER_ITEMS:"GET_FOLDER_ITEMS",SHARE_BOX_FILES:"SHARE_BOX_FILES",UNSHARE_BOX_FILES:"UNSHARE_BOX_FILES",SHARE_FOLDER_ITEMS:"SHARE_FOLDER_ITEMS",UNSHARE_FOLDER_ITEMS:"UNSHARE_FOLDER_ITEMS",GET_EDIT_URL:"GET_EDIT_URL"},AdministrationActionType:{INVITE_USER:"INVITE_USER",VALIDATE_USER_INVITATION_TOKEN:"VALIDATE_USER_INVITATION_TOKEN",ACTIVATE_INVITED_USER:"ACTIVATE_INVITED_USER",RESEND_USER_INVITATION:"RESEND_USER_INVITATION",CREATE_TENANT_SIGNUP_TOKEN:"CREATE_TENANT_SIGNUP_TOKEN",VALIDATE_TENANT_SIGNUP_TOKEN:"VALIDATE_TENANT_SIGNUP_TOKEN",SIGNUP_NEW_TENANT:"SIGNUP_NEW_TENANT",GET_USERS:"GET_USERS",SUSPEND_USER:"SUSPEND_USER",UNSUSPEND_USER:"UNSUSPEND_USER",DELETE_USER:"DELETE_USER",GET_TENANT_LICENSES:"GET_TENANT_LICENSES",INVITE_MULTIPLE_USERS:"INVITE_MULTIPLE_USERS",GET_SHARED_KEY:"GET_SHARED_KEY",CHECK_INVALID_TENANTS:"CHECK_INVALID_TENANTS",GET_TENANT:"GET_TENANT",SET_ROLE:"SET_ROLE",ASSIGN_PHONE_NUMBER:"ASSIGN_PHONE_NUMBER",GET_TELEPHONY_STATUS:"GET_TELEPHONY_STATUS",SET_TELEPHONY_TRUNK_DATA:"SET_TELEPHONY_TRUNK_DATA",GET_TELEPHONY_TRUNK_STATUS:"GET_TELEPHONY_TRUNK_STATUS",SET_TENANT_BRIDGE_NUMBERS:"SET_TENANT_BRIDGE_NUMBERS",GET_TENANT_BRIDGE_NUMBERS:"GET_TENANT_BRIDGE_NUMBERS",UPLOAD_EXTENSION_CONFIGURATION:"UPLOAD_EXTENSION_CONFIGURATION",GET_TENANT_EXTENSIONS:"GET_TENANT_EXTENSIONS",DELETE_EXTENSION:"DELETE_EXTENSION",SET_EXTENSION_STATE:"SET_EXTENSION_STATE"},InvitationResponseCode:{ERROR:"ERROR",LICENSE_ERROR:"LICENSE_ERROR",INVITATION_NOT_SEND:"INVITATION_NOT_SEND",INVALID_USER_STATE:"INVALID_USER_STATE",INVITATION_SEND:"INVITATION_SEND",EMAIL_ALREADY_EXISTS:"EMAIL_ALREADY_EXISTS",SYSTEM_OVERLOADED:"SYSTEM_OVERLOADED"},InvitationStatusCode:{RUNNING:"RUNNING",FINISHED:"FINISHED"},GetUsersOrdering:{ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"},GetUsersSorting:{USER_NAME:"USER_NAME",DATA_USAGE:"DATA_USAGE",LAST_ACCESS:"LAST_ACCESS",ROLE:"ROLE",STATUS:"STATUS",PHONE_NUMBER_ASSIGNED:"PHONE_NUMBER_ASSIGNED"},GetUsersSearchFor:{ROLE:"ROLE",STATUS:"STATUS",NAME:"NAME",PRIMARY_EMAIL:"PRIMARY_EMAIL"},SetRoleRole:{ADMIN:"ADMIN",USER:"USER"},TrunkState:{UP:"UP",DOWN:"DOWN",NOT_REQUESTED:"NOT_REQUESTED",REQUESTED:"REQUESTED"},UploadManifestResponseCode:{UPLOAD_SUCCESS:"UPLOAD_SUCCESS",INVALID_JSON_FORMAT:"INVALID_JSON_FORMAT",CONSTRAINT_VIOLATION:"CONSTRAINT_VIOLATION"},Constraint:{NOT_BLANK:"NOT_BLANK",URL:"URL",BASE64_ICON:"BASE64_ICON"},AdministrationEventType:{INVITE_MULTIPLE_USERS:"INVITE_MULTIPLE_USERS"},ExtensionState:{ENABLED:"ENABLED",DISABLED:"DISABLED"},ThirdPartyConnectorsActionType:{GET_SETTINGS:"GET_SETTINGS",SAVE_SETTINGS:"SAVE_SETTINGS"},ThirdPartyConnectorType:{EXCHANGE_CONNECTOR:"EXCHANGE_CONNECTOR",BOX:"BOX",OPEN_XCHANGE:"OPEN_XCHANGE"},ThirdPartyEventType:{CONNECTED_TO_THIRDPARTY:"CONNECTED_TO_THIRDPARTY",DISCONNECTED_FROM_THIRDPARTY:"DISCONNECTED_FROM_THIRDPARTY"},GuestActionType:{VALIDATE_SESSION_INVITE_TOKEN:"VALIDATE_SESSION_INVITE_TOKEN",REGISTER_SESSION_GUEST:"REGISTER_SESSION_GUEST"},SessionInviteInfoResult:{INVALID:"INVALID",VALID_NOSESSION:"VALID_NOSESSION",VALID_SESSION:"VALID_SESSION"},FeatureName:{TELEPHONY:"TELEPHONY"},LabFeatureName:{CIRCUIT_BOARDS:"CIRCUIT_BOARDS",CONFERENCE_DETAILS:"CONFERENCE_DETAILS",EXTENSIONS:"EXTENSIONS",FAVORITES:"FAVORITES",GLOBAL_PANEL:"GLOBAL_PANEL",IN_CALL_DEVICE_SELECTION:"IN_CALL_DEVICE_SELECTION",JABRA_CALL_CONTROL:"JABRA_CALL_CONTROL",LDAP_CONNECTOR:"LDAP_CONNECTOR",MEETING_POINT:"MEETING_POINT",MENTIONING:"MENTIONING",MS_OUTLOOK_INTEGRATION:"MS_OUTLOOK_INTEGRATION",MUTE_OTHER_PARTICIPANTS:"MUTE_OTHER_PARTICIPANTS",NEW_CONVERSATION_MODEL:"NEW_CONVERSATION_MODEL",NEW_EDITOR:"NEW_EDITOR",OPEN_XCHANGE:"OPEN_XCHANGE",SCHEDULING:"SCHEDULING",TEST_CALL:"TEST_CALL",TEXT_TO_SPEECH:"TEXT_TO_SPEECH",VIDEO_RECORDING:"VIDEO_RECORDING",VOTING:"VOTING"},DraftType:{PRIVATE:"PRIVATE",OPEN:"OPEN",BRIDGE:"BRIDGE"},UserRoutingMessageType:{ATC:"ATC",CMP:"CMP"},VotingType:{ACCEPT_DECLINE:"ACCEPT_DECLINE",APPROVE_REJECT:"APPROVE_REJECT",YES_NO:"YES_NO",YES_NO_MAYBE:"YES_NO_MAYBE",A_B:"A_B",ONE_TWO_THREE_FOUR:"ONE_TWO_THREE_FOUR"}}),e=function(){function a(a){if(!a)return"";var b={};if(e.forEach(function(c){void 0!==a[c]&&null!==a[c]&&(b[c]=a[c])}),c.isEmptyObject(b))return"";var d=JSON.stringify(b);return d=c.textToHtmlEscaped(d),f.replace("%%1",d)}function d(a){if(a&&a.text&&a.text.content)try{var d=g.exec(a.text.content);if(d&&d[0]){a.text.content=a.text.content.slice(d[0].length);var f=d[1];if(f){f=c.escapedHtmlToText(f);var h=JSON.parse(f);e.forEach(function(b){void 0!==h[b]&&(a[b]=h[b])})}}}catch(i){b.error("[Proto]: Failed to retrieve private data. ",i)}}var e=["voting"],f="||::$$privateData=%%1::||",g=/^\|\|::\$\$privateData=({.*})::\|\|/;return{SUPPORTED_PRIVATE_DATA_FIELDS:e,convertPrivateDataToContent:a,retrievePrivateDataFromContent:d}}(),f={requestNr:0,Request:function(a,b){var c={msgType:d.WSMessageType.REQUEST,request:{requestId:++f.requestNr,type:a}};switch(a){case d.ContentType.CONVERSATION:c.request.conversation=b;break;case d.ContentType.USER:c.request.user=b;break;case d.ContentType.RTC_CALL:c.request.rtcCall=b;break;case d.ContentType.RTC_SESSION:c.request.rtcSession=b;break;case d.ContentType.SEARCH:c.request.search=b;break;case d.ContentType.INSTRUMENTATION:c.request.instrumentation=b;break;case d.ContentType.ADMINISTRATION:c.request.administration=b;break;case d.ContentType.SYSTEM:c.request.system=b;break;case d.ContentType.THIRDPARTYCONNECTORS:c.request.thirdpartyconnectors=b;break;case d.ContentType.GUEST:c.request.guest=b;break;case d.ContentType.USER_TO_USER:c.request.userToUser=b}return c},ParseEvent:function(a){var b="",c={};switch(a.type){case d.ContentType.CONVERSATION:switch(b="Conversation."+a.conversation.type,a.conversation.type){case d.ConversationEventType.CREATE:c=a.conversation.create;break;case d.ConversationEventType.UPDATE:c=a.conversation.update;break;case d.ConversationEventType.ADD_ITEM:c=a.conversation.addItem;break;case d.ConversationEventType.ADD_PARTICIPANT:c=a.conversation.addParticipant;break;case d.ConversationEventType.UPDATE_ITEM:c=a.conversation.updateItem;break;case d.ConversationEventType.READ_ITEMS:c=a.conversation.readItems;break;case d.ConversationEventType.TYPING:c=a.conversation.typing;break;case d.ConversationEventType.DRAFT_MESSAGE_SAVED:c=a.conversation.draftMessage;break;case d.ConversationEventType.DRAFT_MESSAGE_DISCARDED:c=a.conversation.draftMessage;break;case d.ConversationEventType.DRAFT_MESSAGE_PUBLISHED:c=a.conversation.draftMessage;break;case d.ConversationEventType.FLAG_ITEM:c=a.conversation.setFlagItem;break;case d.ConversationEventType.CLEAR_FLAGGED_ITEM:c=a.conversation.clearFlaggedItem;break;case d.ConversationEventType.CONVERSATION_MARKED:c=a.conversation.conversationMarked;break;case d.ConversationEventType.CONVERSATION_UNMARKED:c=a.conversation.conversationUnmarked}c.convId=a.conversation.convId;break;case d.ContentType.USER:switch(b="User."+a.user.type,a.user.type){case d.UserEventType.USER_PRESENCE_CHANGE:c=a.user.presenceChanged;break;case d.UserEventType.USER_UPDATED:c=a.user.userUpdated;break;case d.UserEventType.SESSION_CLOSED:c=a.user.sessionClosed;break;case d.UserEventType.PASSWORD_CHANGED:c=a.user.passwordChanged;break;case d.UserEventType.USER_SETTING_UPDATED:c=a.user.userSettingUpdated;break;case d.UserEventType.TELEPHONY_DATA:c=a.user.telephonyData}c.userId=a.user.userId;break;case d.ContentType.RTC_CALL:switch(b="RTCCall."+a.rtcCall.type,a.rtcCall.type){case d.RTCCallEventType.SDP_ANSWER:c=a.rtcCall.sdpAnswer;break;case d.RTCCallEventType.SDP_FAILED:c=a.rtcCall.sdpFailed;break;case d.RTCCallEventType.INVITE:c=a.rtcCall.invite;break;case d.RTCCallEventType.INVITE_CANCEL:c=a.rtcCall.inviteCancel;break;case d.RTCCallEventType.INVITE_FAILED:c=a.rtcCall.inviteFailed;break;case d.RTCCallEventType.CHANGE_MEDIA_TYPE_REQUESTED:c=a.rtcCall.changeMediaRequested}c.sessionId=a.rtcCall.sessionId;break;case d.ContentType.RTC_SESSION:switch(b="RTCSession."+a.rtcSession.type,a.rtcSession.type){case d.RTCSessionEventType.SESSION_STARTED:c=a.rtcSession.sessionStarted;break;case d.RTCSessionEventType.SESSION_TERMINATED:c=a.rtcSession.sessionTerminated;break;case d.RTCSessionEventType.SESSION_UPDATED:c=a.rtcSession.sessionUpdated;break;case d.RTCSessionEventType.SESSION_MOVED:c=a.rtcSession.sessionMoved;break;case d.RTCSessionEventType.PARTICIPANT_JOINED:c=a.rtcSession.participantJoined;break;case d.RTCSessionEventType.PARTICIPANT_LEFT:c=a.rtcSession.participantLeft;break;case d.RTCSessionEventType.PARTICIPANT_UPDATED:c=a.rtcSession.participantUpdated;break;case d.RTCSessionEventType.ACTIVE_SPEAKER:c=a.rtcSession.speaker;break;case d.RTCSessionEventType.VIDEO_ACTIVE_SPEAKER:c=a.rtcSession.videoSpeaker;break;case d.RTCSessionEventType.SESSION_RECORDING_STARTED:c=a.rtcSession.sessionRecordingStarted;break;case d.RTCSessionEventType.SESSION_RECORDING_STOPPED:c=a.rtcSession.sessionRecordingStopped;break;case d.RTCSessionEventType.SESSION_RECORDING_FAILED:c=a.rtcSession.sessionRecordingFailed}c.sessionId=a.rtcSession.sessionId;break;case d.ContentType.SEARCH:switch(b="Search."+a.search.type,a.search.type){case d.SearchEventType.BASIC_SEARCH_RESULT:c=a.search.basicSearchResult;break;case d.SearchEventType.DETAILED_SEARCH_RESULT:c=a.search.detailSearchResult;break;case d.SearchEventType.SEARCH_STATUS:c=a.search.searchStatus;break;case d.SearchEventType.RECENT_SEARCH_ADDED:c=a.search.recentSearchAdded}c.searchId=a.search.searchId;break;case d.ContentType.SYSTEM:switch(b="System."+a.system.type,a.system.type){case d.SystemEventType.MAINTENANCE:c=a.system.maintenance;break;case d.SystemEventType.CLIENT_UPDATE:c=a.system.update}break;case d.ContentType.ADMINISTRATION:switch(b="Administration."+a.administration.type,a.administration.type){case d.AdministrationEventType.INVITE_MULTIPLE_USERS:c=a.administration.inviteMultipleUsers}break;case d.ContentType.THIRDPARTYCONNECTORS:switch(b="ThirdParty."+a.thirdParty.type,a.thirdParty.type){case d.ThirdPartyEventType.CONNECTED_TO_THIRDPARTY:c=a.thirdParty.provider;break;case d.ThirdPartyEventType.DISCONNECTED_FROM_THIRDPARTY:c=a.thirdParty.provider}break;case d.ContentType.USER_TO_USER:switch(b="UserToUser."+a.userToUser.userToUser.type,a.userToUser.userToUser.type){case d.UserRoutingMessageType.ATC:c=a.userToUser.userToUser;break;case d.UserRoutingMessageType.CMP:c=a.userToUser.userToUser}break;default:return null}return{name:b,data:c}},getMediaType:function(a){if(!a)return{audio:!1,video:!1,desktop:!1};var b={audio:!1,video:!1,desktop:!1};return a.forEach(function(a){switch(a){case d.RealtimeMediaType.AUDIO:b.audio=!0;break;case d.RealtimeMediaType.VIDEO:b.video=!0;break;case d.RealtimeMediaType.DESKTOP_SHARING:b.desktop=!0}}),b}};return a.Constants=d,a.PrivateData=e,a.Proto=f,a}(Circuit),Circuit=function(a){"use strict";function b(){function a(a){var b,c;c=a.height,b=a.width,c/b>h/i?a.height>h&&(b=b*h/c,c=h):b>i&&(c=c*i/b,b=i);var d=document.createElement("canvas"),e=d.getContext("2d");return d.width=b,d.height=c,e.fillStyle=f,e.fillRect(0,0,d.width,d.height),e.drawImage(a,0,0,a.width,a.height,0,0,b,c),d.toDataURL("image/jpeg")}function b(a){for(var b=atob(a.split(",")[1]),c=[],d=0;d<b.length;d++)c.push(b.charCodeAt(d));return new Blob([new Uint8Array(c)],{type:"image/jpeg"})}function d(c){return new Promise(function(d){var e=new FileReader;e.onload=function(e){var f=new Image;f.onload=function(){var e=a(this),f=b(e);f.name=j+c.name,f.lastModified=Math.round(Date.now()/1e3),d(f)},f.src=e.target.result},e.readAsDataURL(c)})}function e(a,b,c){return new Promise(function(d,e){var f=new XMLHttpRequest;f.withCredentials=!0,f.open("POST","https://"+c+"/fileapi?itemid="+(b||"NULL"),!0),f.setRequestHeader("Content-Type",a.type),f.setRequestHeader("Content-Disposition",'attachment; filename="'+a.name+'"'),f.onload=function(){200===f.status?d(f.response):e("Unable to upload "+a.name+". Reason: "+f.statusText)},f.onerror=function(){e("Network Error")},f.send(a)})}var f="#f0f0f0",g=10,h=312,i=484,j="tHuMbNaIl___";this.uploadFiles=function(a,b){if(a.length>g)return Promise.reject("Exceeded maximum of 10 files per message");var f=[],h=[];return a.forEach(function(a){c.isSupportedImage&&c.isSupportedImage(a.type)&&h.push(d(a))}),Promise.all(h).then(function(c){a=a.concat(c);var d=null;return a.reduce(function(a,c){return a.then(function(){return e(c,d,b).then(function(a){var b=JSON.parse(a)[0];d=d||b.id;var e={fileId:b.fileid[b.fileid.length-1],fileName:c.name,itemId:d,mimeType:b.mimeType||c.type,size:c.size};return f.push(e),f})})},Promise.resolve())})}}var c=a.Utils;return a.FileUpload=b,a}(Circuit||{}),Circuit=function(a){"use strict";function b(a){var b={};this.dispatch=function(c){
var d=c&&c.type;return d?void(b[d]?b[d].forEach(function(b){try{b(c)}catch(d){a&&a.error(d)}}):a&&a.debug("[EventTarget]: There is no listener for "+d)):void(a&&a.error("[EventTarget]: Attempted to dispatch a bad event"))},this.addEventListener=function(c,d){return b[c]||(b[c]=[]),b[c].indexOf(d)>=0?void(a&&a.warning("[EventTarget]: Attempted to add duplicate event listener")):(b[c].push(d),void(a&&a.debug("[EventTarget]: Added event listener for "+this.name+", type = "+c+", count = "+b[c].length)))},this.removeEventListener=function(c,d){if(b[c]){var e=b[c].indexOf(d);e>=0&&b[c].splice(e,1),a&&a.debug("[EventTarget]: Removed event listener for "+this.name+", type = "+c+", count = "+b[c].length)}},this.removeAllListeners=function(){b={}}}return b.prototype.constructor=b,b.prototype.createEvent=function(a){return{type:a}},b.prototype.dispatchEvent=function(a){var b=this.createEvent(a);this.dispatch(b)},a.BaseEventTarget=b,a}(Circuit||{}),Circuit=function(a){"use strict";function b(a){function b(a,b){if("function"==typeof a)try{a(b)}catch(d){c.error(d)}}function f(a,c){b(t.onStateChange,{newState:a,oldState:c})}function g(){b(t.onReconnectFailed)}function h(a){b(t.onMessage,a)}function i(a){if(a!==x){c.debug("[CONN]: Changed connection state from "+x+" to "+a),c.debug("[CONN]: Raising connectionStateChange event");var b=x;x=a,window.setTimeout(function(){f(a,b)},0)}}function j(a){try{v&&v(a)}catch(b){c.error("[CONN]: Exception on errorCallback. ",b)}finally{v=null,w=null}}function k(){try{c.debug("[CONN]: Registered Successfully"),w&&w()}catch(a){c.error("[CONN]: Exception on successCallback. ",a)}finally{v=null,w=null}}function l(a){return u&&x!==e.Disconnected?(c.debug("[CONN]: Disconnecting from server"),u.close(),u=null,A&&(window.clearTimeout(A),A=null),void(a||i(e.Disconnected))):void c.debug("[CONN]: Client is already disconnected")}function m(){if(x===e.Connecting||x===e.Reconnecting){c.info("[CONN]: Opening WebSocket to ",D);try{switch(window.navigator.platform){case"iOS":u=WebSocket.createWebSocket(D);break;case"node":u=new WebSocket(D,C.cookie);break;default:u=new WebSocket(D)}}catch(a){return c.error("[CONN]: Failed to connect WebSocket. ",a),void j(a)}u.onopen=function(){c.info("[CONN]: WebSocket is opened"),y=o+d.randomNumber(0,p),z=0,x!==e.Disconnected&&(i(e.Connected),k()),n>0&&(B=window.setInterval(function(){u&&u.send("PING")},n))},u.onclose=function(){switch(c.info("[CONN]: WebSocket is closed"),B&&(window.clearInterval(B),B=null),x){case e.Connected:case e.Reconnecting:if(x===e.Reconnecting&&g(),i(e.Reconnecting),"iOS"===window.navigator.platform)return void c.warning("[CONN]: iOS - Do not attempt to reconnect from JS");if(s>0&&z>=s)return c.warning("[CONN]: Reached max number of attempts reconnecting to WebSocket"),void l();c.info("[CONN]: Retry to open socket in "+Math.floor(y/1e3)+" seconds"),A=window.setTimeout(function(){A=null,m()},y),y=++z>q?2*y:p,y=Math.min(y,r);break;case e.Connecting:l(),c.error("[CONN]: Failed to open WebSocket connection"),j("Failed to open WebSocket connection")}},u.onmessage=function(a){try{if("message"!==a.type&&"Text"!==a.type)return void c.error("[CONN]: Message discarded (unknown type):",a.type);var b=a.data;if(!C.doNotParseMessages)try{b=JSON.parse(b)}catch(d){return void c.error("[CONN]: Message discarded (Cannot Parse): "+d+" : ",a.data)}h(b)}catch(e){c.error(e)}},u.onerror=function(a){x!==e.Reconnecting&&x!==e.Connected?(c.error("[CONN]: WebSocket Connection Error"),i(e.Disconnected),u=null,j("Failed to open WebSocket connection")):"node"===window.navigator.platform&&(c.error("[CONN]: Websocked connection error. Force _socket.onclose. ",a),u.onclose())}}}a=a||{};var n,o,p,q,r,s;a.disablePing||"iOS"===window.navigator.platform?(n=-1,o=0,p=0,r=0,s=0,q=0):(n=3e5,o=1e3,p=8e3,r=64e3,s=1350,q=3);var t=this,u=null,v=null,w=null,x=e.Disconnected,y=null,z=0,A=null,B=null,C=a||{},D=null;this.onStateChange=null,this.onReconnectFailed=null,this.onMessage=null,this.getState=function(){return x},this.isConnected=function(){return x===e.Connected},this.connect=function(a,b,d){c.debug("[CONN]: Connect WebSocket to ",a),x!==e.Disconnected&&l(!0),D=a,w=b||function(){},v=d||function(){},i(e.Connecting),m()},this.disconnect=function(){c.debug("[CONN]: Disconnect WebSocket from ",D),l()},this.reconnect=function(){c.debug("[CONN]: Reconnect WebSocket to ",D),l(!0),i(e.Reconnecting),window.setTimeout(function(){m()},50)},this.sendMessage=function(a,b){return x!==e.Connected?(c.error("[CONN]: WebSocket is not connected. Cannot send message."),!1):a?(b||c.msgSend("[CONN]: ",a),"string"==typeof a?u.send(a):(delete a.keysToOmitFromLogging,u.send(JSON.stringify(a))),!0):(c.error("[CONN]: Data is missing. Cannot send message."),!1)},this.pingServer=function(){return x!==e.Connected?(c.error("[CONN]: WebSocket is not connected. Cannot ping server."),!1):("iOS"===window.navigator.platform?u.ping():u.send("PING"),!0)}}var c=a.logger,d=a.Utils,e=Object.freeze({Disconnected:"Disconnected",Connecting:"Connecting",Reconnecting:"Reconnecting",Connected:"Connected"});return a.ConnectionController=b,a.Enums=a.Enums||{},a.Enums.ConnectionState=e,a}(Circuit),Circuit=function(a){"use strict";function b(d){function h(){return"wss://"+w+v}function i(a,b,d){if(b){var e=window.setTimeout(function(a){if(c.error("[ConnectionHandler]: Timeout waiting for request response. RequestId:",a),t[a]){delete t[a],b(f.ReturnCode.REQUEST_TIMEOUT);var d=Object.keys(t).length;c.debug("[ConnectionHandler]: Remaining callbacks pending: ",d),0===d&&l()}},p,a);t[a]={cb:b,timer:e,keysToOmitFromResponse:d}}}function j(a){var b=null,d=null;if(a.msgType===f.WSMessageType.RESPONSE){if(!a.response||!a.response.code)return null;a.response.user&&"GET_LOGGED_ON"===a.response.user.type&&a.response.user.getLoggedOn.user&&(a.response.user.getLoggedOn.user.clientId=a.clientId,a.response.user.getLoggedOn.user.apiVersion=a.apiVersion),t[a.response.requestId]&&(d=t[a.response.requestId],d.timer&&window.clearTimeout(d.timer),delete t[a.response.requestId],b={type:"ack",cb:d.cb,data:a.response},d.keysToOmitFromResponse&&(a.keysToOmitFromLogging=d.keysToOmitFromResponse))}else if(a.msgType===f.WSMessageType.EVENT){var e=g.ParseEvent(a.event);e&&e.name?e.name&&s[e.name]&&(d=s[e.name],c.debug("[ConnectionHandler]: Parsed event: ",e.name),b={type:"evt",cbList:d,name:e.name,data:e.data},r.ommitKeysFromLog&&d.keysToOmitFromEvent&&(a.keysToOmitFromLogging=d.keysToOmitFromEvent)):c.error("[ConnectionHandler]: Failed to parse event: ",a.event)}return b}function k(a){c.debug("[ConnectionHandler]: Raising event",a.name),a.cbList.forEach(function(b){try{b(a.data)}catch(d){c.error("[ConnectionHandler]: Error raising event. ",d)}})}function l(){u.length>0&&(c.debug("[ConnectionHandler]: Raise all delayed events"),u.forEach(function(a){window.clearTimeout(a.timeoutId),k(a)}),u=[])}function m(a){c.debug("[ConnectionHandler]: WebSocket connection state changed to ",a.newState),c.debug("[ConnectionHandler]: Raising connectionStateChange event"),a.newState!==e.Connected&&Object.keys(t).length&&window.setTimeout(function(){Object.keys(t).forEach(function(a){var b=t[a];b.timer&&window.clearTimeout(b.timer),b.cb(f.ReturnCode.DISCONNECTED)}),t={},l()});var b=r.createEvent("connectionStateChange");b.newState=a.newState,b.oldState=a.oldState,r.dispatch(b)}function n(){c.debug("[ConnectionHandler]: WebSocket failed to reconnect. Raising reconnectFailed event");var a=r.createEvent("reconnectFailed");r.dispatch(a)}function o(a){var b=j(a);if(b)if(c.msgRcvd("[ConnectionHandler]: ",a),"evt"===b.type)Object.keys(t).length>0?(c.debug("[ConnectionHandler]: Delay event:",b.name),b.timeoutId=window.setTimeout(function(){k(b);var a=u.indexOf(b);-1!==a&&u.splice(a,1)},q),u.push(b)):k(b);else{var d=Object.keys(t).length;c.debug("[ConnectionHandler]: Remaining callbacks pending: ",d),b.cb(null,b.data),0===d&&l()}else switch(a.msgType){case f.WSMessageType.EVENT:c.debug("[ConnectionHandler]: No callback for event "+a.event.type);break;case f.WSMessageType.RESPONSE:c.debug("[ConnectionHandler]: No callback for msg with packetId ="+a.response.requestId);break;default:c.error("[ConnectionHandler]: Unexpected message type")}}b.parent.constructor.call(this,c);var p=6e4,q=500,r=this,s={},t={},u=[],v="/api",w=window.location.host,x=new a.ConnectionController(d);x.onStateChange=m,x.onReconnectFailed=n,x.onMessage=o,this.ommitKeysFromLog=!0,this.onMessage=o,this.setRelativeUrl=function(a){v=a},this.setTarget=function(a){w=a||window.location.host,c.debug("[ConnectionHandler]: Set target to ",w)},this.getUrl=h,this.getState=function(){return x.getState()},this.connect=function(a,b){c.debug("[ConnectionHandler]: Connect WebSocket to Access Server"),x.connect(h(),a,b)},this.disconnect=function(){c.debug("[ConnectionHandler]: Disconnect WebSocket from Access Server"),x.disconnect()},this.reconnect=function(){c.debug("[ConnectionHandler]: Reconnect WebSocket to Access Server"),x.reconnect()},this.sendMessage=function(a,b,d){return a&&a.request&&a.request.requestId?(c.debug("[ConnectionHandler]: Sending "+a.request.type+" request"),x.sendMessage(a)?(b&&i(a.request.requestId,b,d),!0):(c.error("[ConnectionHandler]: Failed to send message"),b&&window.setTimeout(function(){b(f.ReturnCode.FAILED_TO_SEND)},0),!1)):(c.error("[ConnectionHandler]: Cannot send message. Invalid message: ",a),b&&window.setTimeout(function(){b(f.ReturnCode.INVALID_MESSAGE)},0),!1)},this.pingServer=function(){return x.pingServer()},this.on=function(a,b,c){a&&b&&(s[a]=s[a]||[],s[a].push(b),c&&(s[a].keysToOmitFromEvent=c))}}var c=a.logger,d=a.BaseEventTarget,e=a.Enums.ConnectionState,f=a.Constants,g=a.Proto,h=a.Utils;return h.inherit(b,d),b.prototype.name="ConnectionHandler",a.ConnectionHandler=b,a}(Circuit),Circuit=function(a){"use strict";function b(a){function b(a,b,d,e,f){var h=g.Request(a,b);return n?f=null:e&&(h.keysToOmitFromLogging=e),m.sendMessage(h,function(a,b){try{d(a,b)}catch(e){c.error("[ClientApiHandler]: Exception: ",e)}},f),h.request.requestId}function j(a,b,c,d){if(a)return c(a),!1;if(b.code===e.ReturnCode.NO_RESULT)return d?c(null,[]):c(e.ReturnCode.NO_RESULT),!1;var f=b.code;switch(b.code){case e.ReturnCode.OK:case e.ReturnCode.ENTITY_ALREADY_EXISTS:return!0;case e.ReturnCode.SERVICE_EXCEPTION:b.errorInfo&&b.errorInfo.errorCode&&(f=b.errorInfo.errorCode,f===e.ErrorCode.THIRDPARTY_ERROR&&b.errorInfo.thirdpartyError&&(f=b.errorInfo.thirdpartyError.type))}return c(f||e.ReturnCode.UNEXPECTED_RESPONSE),!1}function k(a){var b=[];return a?(a.audio&&b.push(e.RealtimeMediaType.AUDIO),a.video&&b.push(e.RealtimeMediaType.VIDEO),a.desktop&&b.push(e.RealtimeMediaType.DESKTOP_SHARING)):b.push(e.RealtimeMediaType.AUDIO),b}function l(a){return{convId:a.convId,rtcSessionId:a.rtcSessionId,ownerId:a.ownerId,sdp:a.sdp,mediaType:k(a.mediaType),callOut:!!a.callOut,handover:!!a.handover,sendInviteCancel:!!a.sendInviteCancel,peerUserId:a.peerUserId||void 0,replaces:a.replaces,from:a.fromDn||a.fromName?{phoneNumber:a.fromDn,displayName:a.fromName}:void 0,to:a.dialedDn?{phoneNumber:a.dialedDn,displayName:a.toName}:void 0,isTelephonyConversation:!!a.isTelephonyConversation,displayName:a.displayName,transactionId:a.transactionId}}var m=new d(a),n=!1;this.connect=function(a,b,c){c&&m.setTarget(c),m.connect(a,b)},this.disconnect=m.disconnect.bind(m),this.reconnect=m.reconnect.bind(m),this.pingServer=m.pingServer.bind(m),this.setTarget=m.setTarget.bind(m),this.setRelativeUrl=m.setRelativeUrl.bind(m),this.addEventListener=m.addEventListener.bind(m),this.removeEventListener=m.removeEventListener.bind(m),this.setDevelopmentMode=function(a){n=!!a,m.ommitKeysFromLog=!a},this.on=function(a,b){var c;switch(a){case"Conversation.ADD_ITEM":c=["event.conversation.addItem.item.text","event.conversation.addItem.item.system.renamedConversation"];break;case"Conversation.UPDATE_ITEM":c=["event.conversation.updateItem.item.text"];break;case"Conversation.CREATE":c=["event.conversation.create.conversation.topic","event.conversation.create.conversation.description"];break;case"Conversation.UPDATE":c=["event.conversation.update.conversation.topic","event.conversation.update.conversation.description","event.conversation.update.conversation.topLevelItem.text","event.conversation.update.conversation.topLevelItem.system"];break;case"User.USER_PRESENCE_CHANGE":c=["event.user.presenceChanged.newState.longitude","event.user.presenceChanged.newState.latitude","event.user.presenceChanged.newState.locationText"]}m.on(a,b,c)},this.logout=function(a){a=a||function(){},c.debug("[ClientApiHandler]: logout...");var d={type:e.UserActionType.LOGOUT,logoff:{invalidate:!0}};b(e.ContentType.USER,d,function(b,c){j(b,c,a)&&a(null)})},this.getUser=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getUser...");var f={type:e.UserActionType.GET_USER_BY_ID,getById:{userId:a}};b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null,b.user.getById.user)})},this.getUsersByName=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getUsersByName...");var f={type:e.UserActionType.GET_USER_BY_NAME,getByName:{condition:a}};b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null,b.user.getByName.user)})},this.updateUser=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: updateUser...");var f={type:e.UserActionType.UPDATE,update:a};b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null,b.user.updateResult.user)})},this.getLoggedOnUser=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getLoggedOnUser...");var d={type:e.UserActionType.GET_LOGGED_ON},f=["response.user.getLoggedOn.user.userPresenceState.longitude","response.user.getLoggedOn.user.userPresenceState.latitude","response.user.getLoggedOn.user.userPresenceState.locationText"];b(e.ContentType.USER,d,function(b,c){j(b,c,a)&&a(null,c.user.getLoggedOn.user,c.user.getLoggedOn.firstWebLogin)},null,f)},this.setPresence=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: setPresence...");var f={type:e.UserActionType.SET_PRESENCE,presence:{state:a.state,inTransit:a.inTransit,longitude:a.longitude,latitude:a.latitude,locationText:a.locationText,isAccurate:a.isAccurate,timeZoneOffset:a.timeZoneOffset,mobile:a.mobile,dndUntil:a.dndUntil}},g=["request.user.presence.longitude","request.user.presence.latitude","request.user.presence.locationText"],h=["response.user.setPresence.state.longitude","response.user.setPresence.state.latitude","response.user.setPresence.state.locationText"];b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null)},g,h)},this.getPresence=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: getPresence...");var g=["response.user.getPresence.states.[].longitude","response.user.getPresence.states.[].latitude","response.user.getPresence.states.[].locationText"],h={type:e.UserActionType.GET_PRESENCE,getPresence:{userIds:a,full:!!d}};b(e.ContentType.USER,h,function(a,b){j(a,b,f)&&f(null,b.user.getPresence.states)},null,g)},this.subscribePresence=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: subscribePresence...");var f={type:e.UserActionType.SUBSCRIBE_PRESENCE,subscribePresence:{userIds:a}};b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null)})},this.unsubscribePresence=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: unsubscribePresence...");var f={type:e.UserActionType.UNSUBSCRIBE_PRESENCE,unsubscribePresence:{userIds:a}};b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null)})},this.changePassword=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: changePassword...");var g={type:e.UserActionType.CHANGE_PASSWORD,changePassword:{oldPassword:a,newPassword:d}},h=["request.user.changePassword.oldPassword","request.user.changePassword.newPassword"];b(e.ContentType.USER,g,function(a,b){j(a,b,f)&&f(null,b.user.changePasswordResult.changeResult)},h)},this.getLdapTechnicalUserPresence=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getLdapTechnicalUserPresence...");var d={type:e.UserActionType.GET_LDAP_TECHNICAL_USER_PRESENCE};b(e.ContentType.USER,d,function(b,c){j(b,c,a)&&a(null,c.user.getLdapTechnicalUserPresenceResult.state)})},this.requestEmailChange=function(a,d,f){c.debug("[ClientApiHandler]: requestEmailChange");var g={type:e.UserActionType.GENERATE_EMAIL_UPDATE_TOKEN,generateEmailUpdateToken:{userId:a,emailAddress:d}};b(e.ContentType.USER,g,function(a,b){j(a,b,f)&&f(null)})},this.getUsersByIds=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getUsersByIds...");var f={type:e.UserActionType.GET_USERS_BY_IDS,usersByIds:{userIds:a}},g=["response.user.usersByIds.user.[].userPresenceState.longitude","response.user.usersByIds.user.[].userPresenceState.latitude","response.user.usersByIds.user.[].userPresenceState.locationText"];b(e.ContentType.USER,f,function(a,b){if(j(a,b,d)){var c=b.user.usersByIds||b.user.getAll;d(null,c.user)}},null,g)},this.renewToken=function(a,d){d=d||function(a){a?c.error("[ClientApiHandler]: Error renewing token. This client will be automatically logged out",a):c.debug("[ClientApiHandler]: Successfully renewed token.")},c.debug("[ClientApiHandler]: renewToken");var f={type:e.UserActionType.RENEW_TOKEN};b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null,b.user.renewToken)})},this.getUserSettings=function(a,d){d=d||function(){},a=a||e.UserSettingArea.ALL,c.debug("[ClientApiHandler]: getUserSettings...");var f={type:e.UserActionType.GET_USER_SETTINGS,getUserSettings:{areas:a}};b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null,b.user.getUserSettings)})},this.setUserSettings=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: setUserSettings...");var f={type:e.UserActionType.SET_USER_SETTINGS,setUserSettings:{settings:a}};b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null)})},this.getUserByEmail=function(a,c){c=c||function(){};var d={type:e.UserActionType.GET_USER_BY_MAIL,getUserByMail:{emailAddress:a,excludeRoles:[e.UserRole.SUPPORT,e.UserRole.SYSTEM_ADMIN]}};b(e.ContentType.USER,d,function(a,b){j(a,b,c)&&c(null,b.user.getUserByMail.user)})},this.getUsersByEmails=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getUsersByEmails...");var f={type:e.UserActionType.GET_USERS_BY_MAILS,getUsersByMails:{emailAddresses:a,excludeRoles:[e.UserRole.SUPPORT,e.UserRole.SYSTEM_ADMIN]}};b(e.ContentType.USER,f,function(a,b){j(a,b,d,!0)&&d(null,b.user.getUsersByMails.users)})},this.changeUserEmail=function(a,c,d){d=d||function(){};var f={type:e.UserActionType.EMAIL_UPDATE,emailUpdate:{userId:a,emailAddress:c}};b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null,b.user.emailUpdate)})},this.goToSleep=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: goToSleep...");var f={type:e.UserActionType.GO_TO_SLEEP,userId:a};b(e.ContentType.USER,f,function(a,b){j(a,b,d)&&d(null)})},this.wakeUp=function(a){a=a||function(){},c.debug("[ClientApiHandler]: wakeUp...");var d={type:e.UserActionType.WAKE_UP};b(e.ContentType.USER,d,function(b,c){j(b,c,a)&&a(null)})},this.startBasicSearch=function(a,d,f,g){g=g||function(){},c.debug("[ClientApiHandler]: startBasicSearch...");var h={type:e.SearchActionType.START_BASIC_SEARCH,startBasicSearch:{searchTerm:a,priorizedConvs:f||void 0}};b(e.ContentType.SEARCH,h,function(a,b){j(a,b,g)&&g(null,b.search.startSearchResult.searchId)})},this.startDetailSearch=function(a,d,f,g,h){h=h||function(){},c.debug("[ClientApiHandler]: startDetailSearch...");var i={type:e.SearchActionType.START_DETAIL_SEARCH,startDetailSearch:{searchTerm:a,convId:d,searchId:f||void 0,resultSetLimit:g||0}};b(e.ContentType.SEARCH,i,function(a,b){j(a,b,h)&&h(null,b.search.startSearchResult.searchId)})},this.cancelSearch=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: cancelSearch...");var f={type:e.SearchActionType.CANCEL_SEARCH,cancelSearch:{searchId:a}};b(e.ContentType.SEARCH,f,function(a,b){j(a,b,d)&&d(null)})},this.getRecentSearches=function(a){a=a||function(){};var c={type:e.SearchActionType.GET_RECENT_SEARCHES};b(e.ContentType.SEARCH,c,function(b,c){j(b,c,a,!0)&&a(null,c.search.getRecentSearch.recentSearches)})},this.addRecentSearch=function(a,c){c=c||function(){};var d={type:e.SearchActionType.ADD_RECENT_SEARCH,addRecentSearch:{searchTerm:a}};b(e.ContentType.SEARCH,d,function(a,b){j(a,b,c)&&c(null)})},this.startUserSearch=function(a,c){c=c||function(){};var d={type:e.SearchActionType.START_USER_SEARCH,startUserSearch:{query:a}};b(e.ContentType.SEARCH,d,function(a,b){j(a,b,c)&&c(null,b.search.startSearchResult.searchId)})},this.createConversation=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: createConversation...");var f=a.type;f||(f=a.participants.length>2?e.ConversationType.GROUP:e.ConversationType.DIRECT);var g={type:e.ConversationActionType.CREATE,create:{type:f,topic:a.topic,description:a.description||void 0,participants:a.participants,content:a.convItem||void 0,invitations:a.emailAddresses,locale:a.locale}},h=["request.conversation.create.topic","request.conversation.create.description"],i=["response.conversation.create.conversation.topic","response.conversation.create.conversation.description","response.conversation.create.conversation.topLevelItem.system"];b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,d)&&d(null,b.conversation.create.conversation,b.code===e.ReturnCode.ENTITY_ALREADY_EXISTS)},h,i)},this.updateConversation=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: updateConversation...");var f={type:e.ConversationActionType.UPDATE,update:{convId:a.conversationId,topic:a.topic,description:a.description}},g=["request.conversation.update.topic","request.conversation.update.description"],h=["response.conversation.update.conversation.topic","response.conversation.update.conversation.description","response.conversation.update.conversation.topLevelItem.text","response.conversation.update.conversation.topLevelItem.system"];b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.update.conversation)},g,h)},this.addTextItem=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: addTextItem...");var g=a.content&&h.sanitize(a.content)||"";g=f.convertPrivateDataToContent(a)+g;var i={type:e.ConversationActionType.ADD_TEXT_ITEM,addTextItem:{convId:a.convId,parentId:a.parentId,contentType:a.contentType,subject:a.subject,content:g,attachmentMetaData:a.attachmentMetaData,externalAttachmentMetaData:a.externalAttachmentMetaData,preview:a.preview}},k=["request.conversation.addTextItem.subject","request.conversation.addTextItem.content"],l=["response.conversation.addTextItem.item.text"];b(e.ContentType.CONVERSATION,i,function(a,b){j(a,b,d)&&d(null,b.conversation.addTextItem.item)},k,l)},this.addScheduleItem=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: addScheduleItem...");var f=a.schedule.content&&h.sanitize(a.schedule.content)||"",g={type:e.ConversationActionType.ADD_SCHEDULE_ITEM,addScheduleItem:{convId:a.convId,attachmentMetaData:a.attachmentMetaData,externalAttachmentMetaData:a.externalAttachmentMetaData,startTime:a.schedule.startTime,endTime:a.schedule.endTime,state:a.schedule.state,subject:a.schedule.subject,content:f,attendees:a.schedule.attendees,guestAttendees:a.schedule.guestAttendees,calendarProvider:a.schedule.calendarProvider,calendarId:a.schedule.calendarId,calendarItemId:a.schedule.calendarItemId,recurrence:a.schedule.recurrence}},i=["request.conversation.addScheduleItem.subject","request.conversation.addScheduleItem.content"],k=["response.conversation.addScheduleItem.item.text"];b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,d)&&d(null,b.conversation.addScheduleItem.item)},i,k)},this.updateScheduleItem=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: addScheduleItem...");var f=a.schedule.content&&h.sanitize(a.schedule.content)||"",g={type:e.ConversationActionType.UPDATE_SCHEDULE_ITEM,updateScheduleItem:{convId:a.convId,itemId:a.itemId,attachmentMetaData:a.schedule.attachmentMetaData,externalAttachmentMetaData:a.schedule.externalAttachmentMetaData,startTime:a.schedule.startTime,endTime:a.schedule.endTime,state:a.schedule.state,subject:a.schedule.subject,content:f,attendees:a.schedule.attendees,guestAttendees:a.schedule.guestAttendees,calendarProvider:a.schedule.calendarProvider,calendarId:a.schedule.calendarId,calendarItemId:a.schedule.calendarItemId,recurrence:a.schedule.recurrence}},i=["request.conversation.addScheduleItem.subject","request.conversation.addScheduleItem.content"],k=["response.conversation.addScheduleItem.item.text"];b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,d)&&d(null,b.conversation.updateScheduleItem.item)},i,k)},this.deleteScheduleItem=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: deleteTextItem...");var f={type:e.ConversationActionType.DELETE_SCHEDULE_ITEM,deleteScheduleItem:{itemId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.deleteScheduleItem.item)})},this.getAllScheduleItems=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getAllScheduleItems...");var d={type:e.ConversationActionType.GET_ALL_USER_SCHEDULE_ITEMS};b(e.ContentType.CONVERSATION,d,function(b,c){j(b,c,a)&&a(null,c.conversation.getAllUserScheduleItemsResult.item)})},this.updateTextItem=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: updateTextItem...");var g=a.content&&h.sanitize(a.content)||"";g=f.convertPrivateDataToContent(a)+g;var i={itemId:a.itemId,convId:a.convId,parentId:a.parentId,contentType:e.TextItemContentType.RICH,subject:a.subject,content:g,attachmentMetaData:a.attachmentMetaData,preview:a.preview||{},clustered:a.clustered,externalAttachmentMetaData:a.externalAttachmentMetaData};i.externalAttachmentMetaData&&0!==i.externalAttachmentMetaData.length||(i.externalAttachmentMetaData=[{type:"BOX",downloadLocation:"",previewLocation:"",attachment:{}}]),i.attachmentMetaData&&0!==i.attachmentMetaData.length||(i.attachmentMetaData=[{}]);var k={type:e.ConversationActionType.UPDATE_TEXT_ITEM,updateTextItem:i},l=["request.conversation.updateTextItem.subject","request.conversation.updateTextItem.content"],m=["response.conversation.updateTextItem.item.text"];b(e.ContentType.CONVERSATION,k,function(a,b){j(a,b,d)&&d(null,b.conversation.updateTextItem.item)},l,m)},this.deleteTextItem=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: deleteTextItem...");var f={type:e.ConversationActionType.DELETE_TEXT_ITEM,deleteTextItem:{itemId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.deleteTextItem.item)})},this.deleteRecording=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: deleteRecording...");var f={type:e.ConversationActionType.DELETE_RECORDING,deleteRecording:{itemId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.deleteRecording.item)})},this.getOpenConversations=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: getOpenConversations...");var g={type:e.ConversationActionType.GET_OPEN_CONVERSATIONS,getOpenConversations:{startIndex:a,numberOfItems:d}},h=["response.conversation.getOpenConversations.conversations"];b(e.ContentType.CONVERSATION,g,function(a,b){if(j(a,b,f,!0)){var c=b.conversation.getOpenConversations;f(null,c.conversations,c.lastItemIndex)}},null,h)},this.getAllOpenConversations=function(a,d,f,g){g=g||function(){},c.debug("[ClientApiHandler]: getAllOpenConversations...");var h={type:e.ConversationActionType.GET_OPEN_CONVERSATIONS,getOpenConversations:{startIndex:a,numberOfItems:d,ownIncluded:!0,sorting:f}},i=["response.conversation.getOpenConversations.conversations"];b(e.ContentType.CONVERSATION,h,function(a,b){if(j(a,b,g,!0)){var c=b.conversation.getOpenConversations;g(null,c.conversations,c.lastItemIndex)}},null,i)},this.joinOpenConversation=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: JoinOpenConversation...");var f={type:e.ConversationActionType.JOIN_OPEN_CONVERSATION,joinOpenConversation:{convId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.joinOpenConversation.conv)})},this.getConversationThreads=function(a,d,f,g,h,i,k,l){l=l||function(){},c.debug("[ClientApiHandler]: getConversationThreads...");var m={type:e.ConversationActionType.GET_CONVERSATION_THREADS,getConversationThreads:{convId:a,timestamp:d||void 0,timestampFilter:f||e.OrderType.MODIFICATION,direction:g||e.SearchDirection.AFTER,numberOfThreads:h||void 0,commentsPerThread:i||void 0,includeParents:k||!0}};b(e.ContentType.CONVERSATION,m,function(a,b){if(j(a,b,l,!0)){var c=b.conversation.getConversationThreadsResult;l(null,c.conversationThreads,c.hasMoreItems)}})},this.getThreadComments=function(a,d,f,g,h,i,k){k=k||function(){},c.debug("[ClientApiHandler]: getThreadComments...");var l={type:e.ConversationActionType.GET_THREAD_COMMENTS,getThreadComments:{convId:a,threadId:d,timestamp:f||void 0,timestampFilter:g||e.OrderType.CREATION,direction:h||void 0,totalComments:i||void 0}},m=["response.conversation.getThreadComments.items.[].attachments","response.conversation.getThreadComments.items.[].externalAttachments","response.conversation.getThreadComments.items.[].text"];b(e.ContentType.CONVERSATION,l,function(a,b){if(j(a,b,k,!0)){var c=b.conversation.getThreadCommentsResult;k(null,c.comments,c.hasMoreComments)}},null,m)},this.getConversations=function(a,d,f,g,h,i){i=i||function(){},c.debug("[ClientApiHandler]: getConversations...");var k=f?e.SearchDirection.BEFORE:e.SearchDirection.AFTER,l={type:e.ConversationActionType.GET_CONVERSATIONS,getConversations:{userId:a,modificationDate:d||void 0,direction:k,number:g||void 0,filter:h||e.ConversationFilter.ALL}},m=["response.conversation.getConversations.conversations"];b(e.ContentType.CONVERSATION,l,function(a,b){j(a,b,i,!0)&&i(null,b.conversation.getConversations.conversations)},null,m)},this.getSupportConversation=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getSupportConversation...");var d={type:e.ConversationActionType.GET_SUPPORT_CONVERSATION};b(e.ContentType.CONVERSATION,d,function(b,c){j(b,c,a)&&a(null,c.conversation.getSupportConversation.conversation)})},this.getSupportConversationId=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getSupportConversationId...");var d={type:e.ConversationActionType.GET_SUPPORT_CONVERSATION_ID};b(e.ContentType.CONVERSATION,d,function(b,c){j(b,c,a)&&a(null,c.conversation.getSupportConversationId.conversationId)})},this.getTelephonyConversationId=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getTelephonyConversationId...");var d={type:e.ConversationActionType.GET_TELEPHONY_CONVERSATION_ID};b(e.ContentType.CONVERSATION,d,function(b,c){j(b,c,a)&&a(null,c.conversation.getTelephonyConversationId.conversationId)})},this.getMarkedConversationsList=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getMarkedConversationsList...");var d=i.getItem("favorites"),f=d?JSON.parse(d):[],g={type:e.ConversationActionType.GET_MARKED_CONVERSATIONS_LIST};b(e.ContentType.CONVERSATION,g,function(b,c){if(c&&c.code===e.ReturnCode.NO_RESULT&&f.length>0&&(c.code=e.ReturnCode.OK,c.conversation={}),j(b,c,a)){var d=c.conversation.getMarkedConversationsList||{};d.mutedConvIds=d.mutedConvIds||[],d.favoritedConvIds=f,a(null,d)}})},this.markConversation=function(a,c){if(c=c||function(){},a.markType===e.ConversationMarkFilter.FAVORITE){var d=i.getItem("favorites"),f=d?JSON.parse(d):[];return f.unshift(a.convId),i.setItem("favorites",JSON.stringify(f)),m.onMessage({msgType:"EVENT",event:{type:"CONVERSATION",conversation:{convId:a.convId,type:"CONVERSATION_MARKED",conversationMarked:{convId:a.convId,filter:"FAVORITE"}}}}),void c(null)}var g={type:e.ConversationActionType.MARK_CONVERSATION,markConversation:{convId:a.convId,filter:a.markType}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,c)&&c(null)})},this.unmarkConversation=function(a,c){if(c=c||function(){},a.markType===e.ConversationMarkFilter.FAVORITE){var d=i.getItem("favorites"),f=d?JSON.parse(d):[];return f.splice(f.indexOf(a.convId),1),i.setItem("favorites",JSON.stringify(f)),m.onMessage({msgType:"EVENT",event:{type:"CONVERSATION",
conversation:{convId:a.convId,type:"CONVERSATION_UNMARKED",conversationUnmarked:{convId:a.convId,filter:"FAVORITE"}}}}),void c(null)}var g={type:e.ConversationActionType.UNMARK_CONVERSATION,unmarkConversation:{convId:a.convId,filter:a.markType}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,c)&&c(null)})},this.getConversationUserData=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getConversationUserData..."),a instanceof Array||(a=[a]);var f={type:e.ConversationActionType.GET_CONVERSATION_USER_DATA,getConversationUserData:{conversationId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.getConversationUserData.userData)})},this.getConversationItems=function(a,d,f,g,h,i){i=i||function(){},c.debug("[ClientApiHandler]: getConversationItems...");var k={type:e.ConversationActionType.GET_ITEMS_BY_CONVERSATION,getItemsByConversation:{convId:a,modificationDate:d||void 0,creationDate:f||void 0,direction:g||void 0,number:h||void 0}},l=["response.conversation.getItemsByConversation.items.[].attachments","response.conversation.getItemsByConversation.items.[].externalAttachments","response.conversation.getItemsByConversation.items.[].rtc","response.conversation.getItemsByConversation.items.[].text","response.conversation.getItemsByConversation.items.[].system"];b(e.ContentType.CONVERSATION,k,function(a,b){j(a,b,i,!0)&&i(null,b.conversation.getItemsByConversation.items)},null,l)},this.getItemsByConversationItemId=function(a,d,f,g,h,i){i=i||function(){},c.debug("[ClientApiHandler]: getItemsByConversationItemId...");var k={type:e.ConversationActionType.GET_ITEMS_BY_CONVERSATION_ITEM_ID,getItemsByConversationItemId:{convId:a,itemId:d,direction:f||void 0,number:g||void 0,orderType:h||void 0}},l=["response.conversation.getItemsByConversationItemId.items.[].attachments","response.conversation.getItemsByConversationItemId.items.[].externalAttachments","response.conversation.getItemsByConversationItemId.items.[].rtc","response.conversation.getItemsByConversationItemId.items.[].text","response.conversation.getItemsByConversationItemId.items.[].system"];b(e.ContentType.CONVERSATION,k,function(a,b){j(a,b,i,!0)&&i(null,b.conversation.getItemsByConversationItemId.items)},null,l)},this.getConversationById=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getConversationById...");var f={type:e.ConversationActionType.GET_CONVERSATION_BY_ID,getConversationById:{convId:a}},g=["response.conversation.getConversationById.conversation.topic","response.conversation.getConversationById.conversation.description","response.conversation.getConversationById.conversation.topLevelItem.text","response.conversation.getConversationById.conversation.topLevelItem.system.renamedConversation"];b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.getConversationById.conversation)},null,g)},this.getItemById=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getItemById...");var f={type:e.ConversationActionType.GET_ITEM_BY_ID,getItemById:{itemId:a}},g=["response.conversation.getItemById.item.text"];b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.getItemById.item)},null,g)},this.getItemsByThread=function(a,d,f,g,h,i,k){k=k||function(){},c.debug("[ClientApiHandler]: getItemsByThread...");var l={type:e.ConversationActionType.GET_ITEMS_BY_THREAD,getItemsByThread:{convId:a,threadId:d,modificationDate:f||void 0,creationDate:g||void 0,direction:h||void 0,number:i||void 0}},m=["response.conversation.getItemsByThread.items.[].attachments","response.conversation.getItemsByThread.items.[].externalAttachments","response.conversation.getItemsByThread.items.[].text"];b(e.ContentType.CONVERSATION,l,function(a,b){j(a,b,k,!0)&&k(null,b.conversation.getItemsByThread.items,b.conversation.getItemsByThread.hasMoreItems)},null,m)},this.setReadPointer=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: setReadPointer...");var g={type:e.ConversationActionType.SET_READ_POINTER,setReadPointer:{convId:a,lastReadTimestamp:d}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,f)&&f(null)})},this.getConversationByUser=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getConversationByUser...");var f={type:e.ConversationActionType.GET_CONVERSATION_BY_USER,getConversationByUser:{userId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.getConversationByUser.conversation)})},this.setRole=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: setRole...");var f={type:e.AdministrationActionType.SET_ROLE,setRole:{userId:a.userId,role:a.role}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null)})},this.subscribe=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: subscribe...");var f={type:e.ConversationActionType.SUBSCRIBE,subscribe:{conversationId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null)})},this.unsubscribe=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: unsubscribe...");var f={type:e.ConversationActionType.UNSUBSCRIBE,unsubscribe:{conversationId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null)})},this.typing=function(a,d,f,g){g=g||function(){},c.debug("[ClientApiHandler]: typing...");var h={type:e.ConversationActionType.TYPING,typing:{conversationId:a,isTyping:d,parentItemId:f}};b(e.ContentType.CONVERSATION,h,function(a,b){j(a,b,g)&&g(null)})},this.addParticipant=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: addParticipant...");var f={type:e.ConversationActionType.ADD_PARTICIPANT,addParticipant:{convId:a.convId,userId:a.userId,invitations:a.emailAddresses,locale:a.locale}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.addParticipant)})},this.removeParticipant=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: removeParticipant..."),!d||d instanceof Array||(d=[d]);var g={type:e.ConversationActionType.REMOVE_PARTICIPANT,removeParticipant:{convId:a,userId:d}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,f)&&f(null,b.conversation.removeParticipant.conversation)})},this.getJoinDetails=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: getJoinDetails...");var g={type:e.ConversationActionType.GET_JOIN_DETAILS,getJoinDetails:{conversationId:a,recreate:!!d}},h=["response.conversation.getJoinDetails.tenantPIN","response.conversation.getJoinDetails.sessionPIN"];b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,f)&&f(null,b.conversation.getJoinDetails)},null,h)},this.setFlagItem=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: setFlagItem...");var g={type:e.ConversationActionType.SET_FLAG_ITEM,setFlagItem:{conversationId:a,conversationItemId:d}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,f)&&f(null)})},this.clearFlagItem=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: clearFlagItem...");var g={type:e.ConversationActionType.CLEAR_FLAG_ITEM,clearFlagItem:{conversationId:a,conversationItemId:d}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,f)&&f(null)})},this.getFlaggedItems=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getFlaggedItems...");var d={type:e.ConversationActionType.GET_FLAGGED_ITEMS};b(e.ContentType.CONVERSATION,d,function(b,c){j(b,c,a,!0)&&a(null,c.conversation.getFlaggedItem.flaggedItems)})},this.likeTextItem=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: likeTextItem...");var g={type:e.ConversationActionType.LIKE_TEXT_ITEM,likeTextItem:{conversationItemId:a,userId:d}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,f)&&f(null)})},this.unlikeTextItem=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: unlikeTextItem...");var g={type:e.ConversationActionType.UNLIKE_TEXT_ITEM,unlikeTextItem:{conversationItemId:a,userId:d}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,f)&&f(null)})},this.setConvAvatar=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: setConvAvatar...");var g={type:e.ConversationActionType.SET_CONVERSATION_AVATAR,setConversationAvatar:{convId:a,imageS:d.s,imageL:d.b}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,f)&&f(null,b.conversation.setConversationAvatar.conversation)})},this.deleteConvAvatar=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: deleteConvAvatar...");var f={type:e.ConversationActionType.SET_CONVERSATION_AVATAR,setConversationAvatar:{convId:a,imageS:"",imageL:""}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.setConversationAvatar.conversation)})},this.moderateConversation=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: moderateConversation...");var f={type:e.ConversationActionType.MODERATE_CONVERSATION,moderateConversation:{convId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(b.conversation.moderateResult)})},this.unmoderateConversation=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: unmoderateConversation...");var f={type:e.ConversationActionType.UNMODERATE_CONVERSATION,unmoderateConversation:{convId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(b.conversation.moderateResult)})},this.getConversationSummary=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getConversationSummary...");var f={type:e.ConversationActionType.GET_CONVERSATION_SUMMARY,getConversationSummary:{convId:a}};b(e.ContentType.CONVERSATION,f,function(a,b){j(a,b,d)&&d(null,b.conversation.getConversationSummary.conversationSummary)})},this.grantModeratorRights=function(a,d,f){f=f||function(){},d instanceof Array||(d=[d]),c.debug("[ClientApiHandler]: grantModeratorRights...");var g={type:e.ConversationActionType.GRANT_MODERATOR_RIGHTS,grantModeratorRights:{convId:a,userId:d}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,f)&&f(null,b.conversation.grantModeratorRightsResult)})},this.dropModeratorRights=function(a,d,f){f=f||function(){},d instanceof Array||(d=[d]),c.debug("[ClientApiHandler]: dropModeratorRights...");var g={type:e.ConversationActionType.DROP_MODERATOR_RIGHTS,dropModeratorRights:{convId:a,userId:d}};b(e.ContentType.CONVERSATION,g,function(a,b){j(a,b,f)&&f(null,b.conversation.dropModeratorRightsResult)})},this.joinRtcCall=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: joinRtcCall...");var f={type:e.RTCCallActionType.JOIN,join:l(a)};b(e.ContentType.RTC_CALL,f,function(a,b){j(a,b,d)&&d(null)})},this.answerRtcCall=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: answerRtcCall...");var f={type:e.RTCCallActionType.ANSWER,answer:l(a)};b(e.ContentType.RTC_CALL,f,function(a,b){j(a,b,d)&&d(null)})},this.leaveRtcCall=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: leaveRtcCall...");var f={type:e.RTCCallActionType.LEAVE,leave:{rtcSessionId:a}};b(e.ContentType.RTC_CALL,f,function(a,b){j(a,b,d)&&d(null)})},this.terminateRtcCall=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: terminateRtcCall...");var f={type:e.RTCCallActionType.TERMINATE,terminate:{rtcSessionId:a.rtcSessionId}};b(e.ContentType.RTC_CALL,f,function(a,b){j(a,b,d)&&d(null)})},this.declineRtcCall=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: declineRtcCall...");var f={type:e.RTCCallActionType.INVITE_REJECT,inviteReject:{convId:a.convId,rtcSessionId:a.rtcSessionId,cause:a.cause,transactionId:a.transactionId}};b(e.ContentType.RTC_CALL,f,function(a,b){j(a,b,d)&&d(null)})},this.changeMediaType=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: changeMediaType...");var f={type:e.RTCCallActionType.CHANGE_MEDIA_TYPE,changeMediaType:{rtcSessionId:a.rtcSessionId,sdp:a.sdp,mediaTypes:k(a.mediaType),transactionId:a.transactionId}};b(e.ContentType.RTC_CALL,f,function(a,b){j(a,b,d)&&d(null)})},this.changeMediaAccept=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: changeMediaAccept...");var f={type:e.RTCCallActionType.CHANGE_MEDIA_ACCEPT,changeMediaAccept:{rtcSessionId:a.rtcSessionId,sdp:a.sdp,transactionId:a.transactionId}};b(e.ContentType.RTC_CALL,f,function(a,b){j(a,b,d)&&d(null)})},this.changeMediaReject=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: changeMediaReject...");var f={type:e.RTCCallActionType.CHANGE_MEDIA_REJECT,changeMediaReject:{rtcSessionId:a.rtcSessionId,transactionId:a.transactionId}};b(e.ContentType.RTC_CALL,f,function(a,b){j(a,b,d)&&d(null)})},this.prepareSession=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: prepareSession... ");var f={type:e.RTCCallActionType.PREPARE,prepare:{convId:a.convId,rtcSessionId:a.rtcSessionId,ownerId:a.ownerId}},g=["response.rtcCall.prepare.servers.[].password"];b(e.ContentType.RTC_CALL,f,function(a,b){j(a,b,d)&&d(null,b.rtcCall.prepare.servers)},null,g)},this.renewTurnCredentials=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: renewTurnCredentials... ");var f={type:e.RTCCallActionType.RENEW_TURN_CREDENTIALS,renewTurnCredentials:{rtcSessionId:a}},g=["response.rtcCall.renewTurnCredentials.servers.[].password"];b(e.ContentType.RTC_CALL,f,function(a,b){j(a,b,d)&&d(null,b.rtcCall.renewTurnCredentials.servers)},null,g)},this.lockRtcSession=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: lockRtcSession...");var g={type:e.RTCSessionActionType.LOCK,lock:{rtcSessionId:a,locked:!!d}};b(e.ContentType.RTC_SESSION,g,function(a,b){j(a,b,f)&&f(null)})},this.muteRtcSession=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: muteRtcSession...");var f={type:e.RTCSessionActionType.MUTE_SESSION,muteSession:{rtcSessionId:a.rtcSessionId,muted:!!a.muted,excludedUserIds:a.excludedUserIds||void 0}};b(e.ContentType.RTC_SESSION,f,function(a,b){j(a,b,d)&&d(null)})},this.muteParticipant=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: muteParticipant...");var f={type:e.RTCSessionActionType.MUTE,mute:{rtcSessionId:a.rtcSessionId,muted:!!a.muted,userIds:a.usersIds||void 0}};b(e.ContentType.RTC_SESSION,f,function(a,b){j(a,b,d)&&d(null)})},this.addParticipantToRtcSession=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: addParticipantToRtcCall...");var f={type:e.RTCSessionActionType.ADD_PARTICIPANT,addParticipant:{rtcSessionId:a.rtcSessionId,userId:a.userId,mediaType:k(a.mediaType)}};b(e.ContentType.RTC_SESSION,f,function(a,b){j(a,b,d)&&d(null)})},this.removeSessionParticipant=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: removeSessionParticipant...");var f={type:e.RTCSessionActionType.REMOVE_PARTICIPANT,removeParticipant:{rtcSessionId:a.rtcSessionId,userId:a.userId}};b(e.ContentType.RTC_SESSION,f,function(a,b){j(a,b,d)&&d(null)})},this.getActiveSessions=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getActiveSessions...");var d={type:e.RTCSessionActionType.GET_ACTIVE_SESSIONS};b(e.ContentType.RTC_SESSION,d,function(b,c){j(b,c,a,!0)&&a(null,c.rtcSession.activeSessions.session)})},this.getSession=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getSession...");var f={type:e.RTCSessionActionType.GET_SESSION,getSession:{rtcSessionId:a}};b(e.ContentType.RTC_SESSION,f,function(a,b){j(a,b,d)&&d(null,b.rtcSession.getSession.session)})},this.moveRtcSession=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: moveRtcSession...");var f={type:e.RTCSessionActionType.MOVE,move:{oldRtcSessionId:a.sessionId,oldConversationId:a.conversationId,newConversationId:a.newConversationId,newRtcSessionId:a.newSessionId}};b(e.ContentType.RTC_SESSION,f,function(a,b){j(a,b,d)&&d(null)})},this.startRecording=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: startRecording...");var f={type:e.RTCSessionActionType.START_RECORDING,startRecording:{convId:a.convId,rtcSessionId:a.rtcSessionId,mediaTypes:k(a.mediaTypes)}};b(e.ContentType.RTC_SESSION,f,function(a,b){j(a,b,d)&&d(null)})},this.stopRecording=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: stopRecording...");var f={type:e.RTCSessionActionType.STOP_RECORDING,stopRecording:{convId:a.convId,rtcSessionId:a.rtcSessionId}};b(e.ContentType.RTC_SESSION,f,function(a,b){j(a,b,d)&&d(null)})},this.assignPhoneNumbers=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: assignPhoneNumbers...");var f={type:e.AdministrationActionType.ASSIGN_PHONE_NUMBER,assignPhoneNumbers:{phoneNumbers:a.phoneNumbers,userId:a.userId}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null)})},this.submitClientData=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: submitClientData...");var f={type:e.InstrumentationActionType.SUBMIT_CLIENT_DATA,submitClientData:{instrumentationData:a}};b(e.ContentType.INSTRUMENTATION,f,function(a,b){if(j(a,b,d)){var c=b.instrumentation&&b.instrumentation.submitClientData&&b.instrumentation.submitClientData.submitDataResult;d(null,c||e.SubmitDataResult.OK)}})},this.submitQOSData=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: submitQOSData...");var f={type:e.InstrumentationActionType.SUBMIT_QOS_DATA,submitQOSData:{dataSets:a}};b(e.ContentType.INSTRUMENTATION,f,function(a,b){j(a,b,d)&&d(null)})},this.getUsersForAdmin=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getUsersForAdmin...");var f={type:e.AdministrationActionType.GET_USERS,getUsers:{startIndex:a.startIndex,numberOfItems:a.numberOfItems,ordering:a.ordering}},g=["response.administration.getUsers.users"];b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d,!0)&&d(null,b.administration.getUsers.users)},null,g)},this.getLicenses=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getLicenses...");var d={type:e.AdministrationActionType.GET_TENANT_LICENSES};b(e.ContentType.ADMINISTRATION,d,function(b,c){j(b,c,a)&&a(null,c.administration.getTenantLicenses.licenses)})},this.getTenant=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getTenant...");var d={type:e.AdministrationActionType.GET_TENANT};b(e.ContentType.ADMINISTRATION,d,function(b,c){j(b,c,a)&&a(null,c.administration.getTenant.tenant)})},this.suspendUser=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: suspendUser...");var f={type:e.AdministrationActionType.SUSPEND_USER,suspendUser:{userId:a}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null)})},this.unsuspendUser=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: unsuspendUser...");var f={type:e.AdministrationActionType.UNSUSPEND_USER,unsuspendUser:{userId:a}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null)})},this.deleteUser=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: deleteUser...");var f={type:e.AdministrationActionType.DELETE_USER,deleteUser:{userId:a}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null)})},this.inviteUser=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: inviteUser...");var f={type:e.AdministrationActionType.INVITE_USER,inviteUser:{userAttributes:{emailAddress:a.userAttributes.emailAddress,lastName:a.userAttributes.lastName,firstName:a.userAttributes.firstName},licenseId:a.licenseId}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null,b.administration.inviteUser.resultType)})},this.inviteMultipleUsers=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: inviteMultipleUsers...");var f={type:e.AdministrationActionType.INVITE_MULTIPLE_USERS,inviteMultipleUsers:a};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null)})},this.resendInvite=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: resendInvite...");var f={type:e.AdministrationActionType.RESEND_USER_INVITATION,resendUserInvitation:{userId:a}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null,b.administration.resendUserInvitation.resultType)})},this.checkInvalidTenant=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: checkInvalidTenant...");var f={type:e.AdministrationActionType.CHECK_INVALID_TENANTS,checkInvalidTenants:{tenantIds:a}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null,b.administration.checkInvalidTenants.tenantIds)})},this.getTelephonyData=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getTelephonyData...");var d={type:e.UserActionType.GET_TELEPHONY_DATA};b(e.ContentType.USER,d,function(b,c){j(b,c,a)&&a(null,c.user.getTelephonyData.data)})},this.setTelephonyTrunkData=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: setTelephonyTrunkData...");var f={type:e.AdministrationActionType.SET_TELEPHONY_TRUNK_DATA,setTelephonyTrunkData:{defaultCallerId:a}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d()})},this.getTelephonyTrunkStatus=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getTelephonyTrunkStatus...");var d={type:e.AdministrationActionType.GET_TELEPHONY_TRUNK_STATUS};b(e.ContentType.ADMINISTRATION,d,function(b,c){j(b,c,a)&&a(null,c.administration.getTelephonyTrunkStatus)})},this.getTenantBridgeNumbers=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getTenantBridgeNumbers...");var d={type:e.AdministrationActionType.GET_TENANT_BRIDGE_NUMBERS};b(e.ContentType.ADMINISTRATION,d,function(b,c){j(b,c,a)&&a(null,c.administration.getTenantBridgeNumbers.bridgeNumbers||[])})},this.setTenantBridgeNumbers=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: setTenantBridgeNumbers...");var f={type:e.AdministrationActionType.SET_TENANT_BRIDGE_NUMBERS,setTenantBridgeNumbers:{bridgeNumbers:a}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d()})},this.uploadExtensionConfiguration=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: uploadExtensionConfiguration...");var f={type:e.AdministrationActionType.UPLOAD_EXTENSION_CONFIGURATION,uploadExtensionConfiguration:{configuration:a}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null,b.administration.uploadExtensionConfiguration)})},this.getTenantExtensions=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getTenantExtensions...");var d={type:e.AdministrationActionType.GET_TENANT_EXTENSIONS};b(e.ContentType.ADMINISTRATION,d,function(b,c){j(b,c,a,!0)&&a(null,c.administration.getTenantExtensions.extensions)})},this.deleteExtension=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: deleteExtension...");var f={type:e.AdministrationActionType.DELETE_EXTENSION,deleteExtension:{extensionId:a}};b(e.ContentType.ADMINISTRATION,f,function(a,b){j(a,b,d)&&d(null,b.administration.deleteExtensionResult.extensionConfigurationUrl)})},this.setExtensionState=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: setExtensionState...");var g={type:e.AdministrationActionType.SET_EXTENSION_STATE,setExtensionState:{extensionId:a,state:d}};b(e.ContentType.ADMINISTRATION,g,function(a,b){j(a,b,f)&&f(null,b.administration.setExtensionStateResult.extensionConfigurationUrl)})},this.getUserExtensions=function(a){c.debug("[ClientApiHandler]: getUserExtensions");var d={type:e.UserActionType.GET_USER_EXTENSIONS};b(e.ContentType.USER,d,function(b,c){j(b,c,a,!0)&&a(null,c.user.getUserExtensions.extensions)})},this.setUserExtensionState=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: setUserExtensionState...");var g={type:e.UserActionType.SET_USER_EXTENSION_STATE,setUserExtensionState:{extensionId:a,state:d}};b(e.ContentType.USER,g,function(a,b){j(a,b,f)&&f(null,b.user.setUserExtensionStateResult.extensionConfigurationUrl)})},this.getExchangeSettings=function(a){a=a||function(){},c.debug("[ClientApiHandler]: getExchangeSettings...");var d={type:e.ThirdPartyConnectorsActionType.GET_SETTINGS,getSettings:{type:e.ThirdPartyConnectorType.EXCHANGE_CONNECTOR}},f=["response.thirdpartyconnectors.getSettings.exchange"];b(e.ContentType.THIRDPARTYCONNECTORS,d,function(b,c){j(b,c,a)&&a(null,c.thirdpartyconnectors.getSettings.exchange)},null,f)},this.saveExchangeSettings=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: saveExchangeSettings..."),n&&(a.encryptionKey=String(Date.now()));var f={type:e.ThirdPartyConnectorsActionType.SAVE_SETTINGS,saveSettings:{type:e.ThirdPartyConnectorType.EXCHANGE_CONNECTOR,exchange:a}},g=["request.thirdpartyconnectors.saveSettings.exchange"],h=["response.thirdpartyconnectors.saveSettings.exchange"];b(e.ContentType.THIRDPARTYCONNECTORS,f,function(a,b){j(a,b,d)&&d(null,b.thirdpartyconnectors.saveSettings.exchange)},g,h)},this.saveOpenXchangeSettings=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: saveOpenXchangeSettings...");var f={type:e.ThirdPartyConnectorsActionType.SAVE_SETTINGS,saveSettings:{type:e.ThirdPartyConnectorType.OPEN_XCHANGE,openXchange:a}},g=["request.thirdpartyconnectors.saveSettings.openXchange"],h=["response.thirdpartyconnectors.saveSettings.openXchange"];b(e.ContentType.THIRDPARTYCONNECTORS,f,function(a,b){j(a,b,d)&&d(null,b.thirdpartyconnectors.saveSettings.openXchange)},g,h)},this.connectToThirdParty=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: connectToThirdParty "+a+"...");var f;switch(a){case e.ThirdPartyConnectorType.BOX:f={type:e.ThirdpartyConnectionActionType.CONNECT,connect:{type:a}};break;default:return void d(e.ThirdPartyError.UNSUPPORTED_PROVIDER)}b(e.ContentType.THIRDPARTYCONNECTORS,f,function(a,b){j(a,b,d)&&(b.thirdpartyconnectors.connect?d(null,b.thirdpartyconnectors.connect.authorizeUrl):d(e.ThirdPartyError.UNSUPPORTED_PROVIDER))})},this.getFolderItems=function(a,d,f,g,h){h=h||function(){},c.debug("[ClientApiHandler]: getFolderItems for ",a);var i;switch(a){case e.ThirdPartyConnectorType.BOX:case e.ThirdPartyConnectorType.OPEN_XCHANGE:i={type:e.ThirdpartyConnectionActionType.GET_FOLDER_ITEMS,getFolderItems:{type:a,id:d,index:f,pageSize:g}};break;default:return void h(e.ThirdPartyError.UNSUPPORTED_PROVIDER)}b(e.ContentType.THIRDPARTYCONNECTORS,i,function(a,b){j(a,b,h)&&h(null,{folder:d,items:b.thirdpartyconnectors.getFolderItemsResult})})},this.getConnectionStatus=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getConnectionStatus "+a+"...");var f={type:e.ThirdpartyConnectionActionType.GET_CONNECTION_STATUS,getConnectionStatus:{type:a}};b(e.ContentType.THIRDPARTYCONNECTORS,f,function(a,b){j(a,b,d)&&d(null,b.thirdpartyconnectors.getConnectionStatus.connected)})},this.disconnectFromThirdParty=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: disconnectFromThirdParty "+a+"...");var f;switch(a){case e.ThirdPartyConnectorType.BOX:case e.ThirdPartyConnectorType.OPEN_XCHANGE:f={type:e.ThirdpartyConnectionActionType.DISCONNECT,disconnect:{type:a}};break;default:return void d(e.ThirdPartyError.UNSUPPORTED_PROVIDER)}b(e.ContentType.THIRDPARTYCONNECTORS,f,function(a,b){j(a,b,d)&&d(null)})},this.getSharedItems=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: getSharedItems "+a+"...");var g;switch(a){case e.ThirdPartyConnectorType.BOX:case e.ThirdPartyConnectorType.OPEN_XCHANGE:g={type:e.ThirdpartyConnectionActionType.SHARE_FOLDER_ITEMS,shareFolderItems:{type:a,fileId:d}};break;default:return void f(e.ThirdPartyError.UNSUPPORTED_PROVIDER)}b(e.ContentType.THIRDPARTYCONNECTORS,g,function(a,b){j(a,b,f)&&f(null,b.thirdpartyconnectors.shareFolderItems.items)})},this.unshareItems=function(a,d,f){f=f||function(){},c.debug("[ClientApiHandler]: ushareItems "+a+"...");var g;switch(a){case e.ThirdPartyConnectorType.OPEN_XCHANGE:g={type:e.ThirdpartyConnectionActionType.UNSHARE_FOLDER_ITEMS,unshareFolderItems:{type:a,fileId:d}};break;default:return void f(e.ThirdPartyError.UNSUPPORTED_PROVIDER)}b(e.ContentType.THIRDPARTYCONNECTORS,g,function(a,b){j(a,b,f)&&f(null)})},this.getEditUrl=function(a,d){c.debug("[ClientApiHandler]: getEditUrl "+a.provider);var f;switch(a.provider){case e.ThirdPartyConnectorType.OPEN_XCHANGE:f={type:e.ThirdpartyConnectionActionType.GET_EDIT_URL,getEditUrl:{externalAttachment:{type:a.provider,downloadLocation:a.uri,previewLocation:a.uri,attachment:{fileId:a.fileId,fileName:a.fileName,size:a.size,mimeType:a.mimeType}}}};break;default:return void d(e.ThirdPartyError.UNSUPPORTED_PROVIDER)}b(e.ContentType.THIRDPARTYCONNECTORS,f,function(a,b){j(a,b,d)&&d(null,b.thirdpartyconnectors.getEditUrlResult.url)})},this.getGlobalProperty=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: getGlobalProperty...");var f={type:e.SystemActionType.GET_GLOBAL_PROPERTY,getGlobalProperty:{globalPropertyName:a}};b(e.ContentType.SYSTEM,f,function(a,b){j(a,b,d)&&d(null,b.system.getGlobalPropertyResult.property)})},this.getGlobalProperties=function(a,d){d=d||function(){},a instanceof Array||(a=[a]),c.debug("[ClientApiHandler]: getGlobalProperties...");var f={type:e.SystemActionType.GET_GLOBAL_PROPERTIES,getGlobalProperties:{globalPropertyNames:a}};b(e.ContentType.SYSTEM,f,function(a,b){j(a,b,d)&&d(null,b.system.getGlobalPropertiesResult.property)})},this.validateSessionInvite=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: validateSessionInvite...");var f={type:e.GuestActionType.VALIDATE_SESSION_INVITE_TOKEN,validateSessionInviteToken:{token:{token:a}}};b(e.ContentType.GUEST,f,function(a,b){j(a,b,d)&&d(null,b.guest.validateSessionInviteToken)})},this.registerSessionGuest=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: registerSessionGuest...");var f={type:e.GuestActionType.REGISTER_SESSION_GUEST,registerSessionGuest:{token:{token:a.token},firstName:a.firstName,lastName:a.lastName,forTestCall:a.testCall,locale:a.locale}};b(e.ContentType.GUEST,f,function(a,b){j(a,b,d)&&d(null,b.guest.registerSessionGuestResult)})},this.sendUserToUserAtcRequest=function(a,d){d=d||function(){},c.debug("[ClientApiHandler]: sendUserToUserAtcRequest...");var f={type:e.ContentType.USER_TO_USER,userToUser:{type:e.UserRoutingMessageType.ATC,routing:{destUserId:a.destUserId,srcUserId:a.srcUserId,destClientId:a.destClientId,srcClientId:a.srcClientId},data:JSON.stringify(a.content)}};b(e.ContentType.USER_TO_USER,f,function(a,b){j(a,b,d)&&d(null,b.userToUser)})}}var c=Circuit.logger,d=Circuit.ConnectionHandler,e=Circuit.Constants,f=Circuit.PrivateData,g=Circuit.Proto,h=Circuit.Utils,i=Circuit.storeManager;return b.prototype.constructor=b,b.prototype.name="ClientApiHandler",a.ClientApiHandler=b,a}(Circuit),Circuit=function(a){"use strict";var b=a.Constants,c=a.FileUpload,d=a.logger,e=a.PrivateData,f=a.Enums,g=a.Utils;return Circuit.Injectors={},f.RegistrationState=Object.freeze({Disconnected:"Disconnected",Connected:"Connected"}),a.Client=function(f){function h(a){return new Promise(function(b,c){var d=new XMLHttpRequest("node"===window.navigator.platform?ca:void 0);d.open(a.type||a.dataType||"GET",a.url,!0),d.withCredentials=a.xhrFields&&a.xhrFields.withCredentials,d.onload=function(){200===d.status?(a.success&&a.success(d.response),b(d.response)):(a.error&&a.error(d.statusText),c(new Error(d.statusText)))},d.onerror=function(){var b="Network error or incorrect credentials";a.error&&a.error(b),c(new Error(b))};var e;a.data&&(e="username="+a.data.username+"&password="+a.data.password,d.setRequestHeader("Content-type","application/x-www-form-urlencoded")),d.send(e)})}function i(a){return h({type:"POST",url:"https://"+ba.domain+"/sdklogin",data:{username:a.email,password:a.password},xhrFields:{withCredentials:!0},crossDomain:!0})}function j(){return new Promise(function(a,b){h({url:"https://"+ba.domain+"/data/userData",xhrFields:{withCredentials:!0},crossDomain:!0}).then(function(b){da=JSON.parse(b),a()},function(a){b(a.message)})})}function k(){return new Promise(function(a,b){ia.connect(function(){d.info("Successfully connected to access server."),l("Connected"),a()},function(a){m(a),b(a)},ba.domain)})}function l(a){ba.dispatch({type:"registrationStateChanged",state:a})}function m(a){d.error("Failed to connect: "+a),ba._userData=null,ia.disconnect(),l("Disconnected")}function n(){return new Promise(function(a,b){ia.getLoggedOnUser(function(c,d){return c?void b(c):void W(d).then(function(b){ba.loggedOnUser=b,a(b)})})})}function o(a){return new Promise(function(c,d){a.startIndex=a.startIndex||0,a.numberOfItems=a.numberOfItems||25,a.ordering=a.ordering||b.GetUsersOrdering.ASCENDING,ia.getUsersForAdmin(a,function(a,b){return a?void d(a):void Promise.all(b.map(function(a){return W(a)})).then(function(){c(b)})})})}function p(a){return new Promise(function(c,d){a=a||{},
a.timestamp=a.timestamp||Date.now(),a.direction=a.direction!==b.SearchDirection.AFTER,a.numberOfConversations=a.numberOfConversations||25,ia.getConversations(ba.loggedOnUser.userId,a.timestamp,a.direction,a.numberOfConversations,b.ConversationFilter.ALL,function(a,b){return a?void d(a):void Promise.all(b.map(function(a){return Y(a)})).then(function(){c(b)})})})}function q(a){return new Promise(function(b,c){ia.getConversationById(a,function(a,d){return a?void c(a):void Y(d).then(function(a){b(a)})})})}function r(a){return new Promise(function(b,c){ia.getItemById(a,function(a,d){return a?void c(a):void X(d).then(function(a){b(a)})})})}function s(a,c){return new Promise(function(d,e){c=c||{},c.modificationDate=c.modificationDate||void 0,c.creationTime=c.creationTime||void 0,c.direction=c.direction||b.SearchDirection.BEFORE,c.numberOfItems=c.numberOfItems||25,ia.getConversationItems(a,c.modificationDate,c.creationTime,c.direction,c.numberOfItems,function(a,b){return a?void e(a):void Promise.all(b.map(function(a){return X(a)})).then(function(){d(b)})})})}function t(a){return new Promise(function(b,c){ia.getUserByEmail(a,function(a,d){return a?void c(a):void W(d).then(function(a){b(a)})})})}function u(a){return new Promise(function(b,c){return a?a.length?void ia.getUsersByEmail(a,function(a,d){return a?void c(a):void Promise.all(d.map(function(a){return W(a)})).then(function(){b(d)})}):b([]):c("emails is null")})}function v(a){return new Promise(function(b,c){return a?void ia.getUser(a,function(a,d){return a?void c(a):void W(d).then(function(a){b(a)})}):c("userId is null")})}function w(a){return new Promise(function(b,c){return a?a.length?void ia.getUsersByIds(a,function(a,d){return a?void c(a):void Promise.all(d.map(function(a){return W(a)})).then(function(){b(d)})}):b([]):c("userIds is null")})}function x(){return new Promise(function(a,b){ia.getTelephonyConversationId(function(c,d){return c?void b(c):(ea=d,void a(d))})})}function y(){return new Promise(function(a,b){ia.getSupportConversationId(function(c,d){return c?void b(c):(fa=d,void a(d))})})}function z(a){return new Promise(function(b,c){return a?void ia.getConversationByUser(a,function(a,d){return a?void("NO_RESULT"===a?b():c(a)):void Y(d).then(function(a){b(a)})}):void c("userId is required")})}function A(a){return new Promise(function(b,c){"string"!=typeof a&&c("email or user ID is required"),a.match(g.EMAIL_ADDRESS_PATTERN)?t(a).then(function(a){return a.userId}).then(z).then(Y).then(function(a){b(a)})["catch"](function(a){c(a)}):z(a).then(Y).then(function(a){b(a)},function(a){c(a)})})}function B(a,e){return new Promise(function(f,g){function h(a){ia.addTextItem(a,function(a,b){return a?void g(a):void X(b).then(function(a){f(a)})})}if(!a)return void g("convId is required");if(!e)return void g("content is required");if("string"==typeof e)h({convId:a,content:e,contentType:"RICH"});else{if("object"!=typeof e)return void g("invalid content");var i={convId:a,parentId:e.parentId,contentType:e.contentType||b.TextItemContentType.RICH,subject:e.subject,content:e.content,externalAttachmentMetaData:e.externalAttachments};if(e.attachments&&e.attachments.length>0){var j=new c;j.uploadFiles(e.attachments,ba.domain).then(function(a){i.attachmentMetaData=[],a.forEach(function(a){i.attachmentMetaData.push(a)}),h(i)})["catch"](function(a){d.error("[SDK] Fileupload error.",a),g("error in file upload")})}else h(i)}})}function C(a){return new Promise(function(c,d){var e={type:b.ConversationType.DIRECT,participants:[{userId:a}]};ia.createConversation(e,function(a,b,e){return e?void d("EXISTS"):a?void d(a):void Y(b).then(function(a){c(a)})})})}function D(a){return new Promise(function(b,c){return"string"!=typeof a?void c("participant email or user ID is required"):void(a.match(g.EMAIL_ADDRESS_PATTERN)?t(a).then(function(a){return a.userId}).then(C).then(Y).then(function(a){b(a)})["catch"](function(a){c(a)}):C(a).then(Y).then(function(a){b(a)},function(a){c(a)}))})}function E(a,c){return new Promise(function(d,e){a=a.map(function(a){return{userId:a}});var f={type:b.ConversationType.GROUP,participants:a,topic:c};ia.createConversation(f,function(a,b){return a?void e(a):void Y(b).then(function(a){d(a)})})})}function F(a,c,d){return new Promise(function(e,f){a&&0!==a.length||(a=[ba.loggedOnUser.userId]),a=a.map(function(a){return{userId:a}});var g={type:b.ConversationType.OPEN,participants:a,topic:c,description:d};ia.createConversation(g,function(a,b){return a?void f(a):void Y(b).then(function(a){e(a)})})})}function G(a,b){return new Promise(function(c,d){var e={convId:a,participants:b};ia.addParticipants(e,function(a){return a?void d(a):void c()})})}function H(a,b){return new Promise(function(c,d){ia.removeParticipants(a,b,function(a){return a?void d(a):void c()})})}function I(a,b){return new Promise(function(c,d){ia.setFlagItem(a,b,function(a){return a?void d(a):void c()})})}function J(a,b){return new Promise(function(c,d){ia.clearFlagItem(a,b,function(a){return a?void d(a):void c()})})}function K(a){return new Promise(function(b,c){ia.likeTextItem(a,ba.loggedOnUser.userId,function(a){return a?void c(a):void b()})})}function L(a){return new Promise(function(b,c){ia.unlikeTextItem(a,ba.loggedOnUser.userId,function(a){return a?void c(a):void b()})})}function M(a,b){return new Promise(function(c,d){b=b||Date.now(),ia.setReadPointer(a,b,function(a){return a?void d(a):void c()})})}function N(a){return new Promise(function(b,c){ia.updateUser(a,function(a){return a?void c(a):void b()})})}function O(a,b){return new Promise(function(c,d){ia.changePassword(a,b,function(a){return a?void d(a):void c()})})}function P(a){return new Promise(function(b,c){ia.setPresence(a,function(a){return a?void c(a):void b()})})}function Q(a,b){return new Promise(function(c,d){ia.getPresence(a,b,function(a,b){return a?void d(a):void c(b)})})}function R(a){return new Promise(function(b,c){ia.subscribePresence(a,function(a){return a?void c(a):void b()})})}function S(a){return new Promise(function(b,c){ia.unsubscribePresence(a,function(a){return a?void c(a):void b()})})}function T(){return new Promise(function(a,b){ia.renewToken(ba.loggedOnUser.userId,function(c,d){return c?void b(c):void a(d)})})}function U(a){return new Promise(function(b,c){ia.startUserSearch(a,function(a,d){return a?void c(a):void b(d)})})}function V(a){var b=0;if(a)for(var c=0;c<a.length;c++)b+=a.charCodeAt(c);return ma[b%ma.length]}function W(a){if(a.smallImageUri&&a.largeImageUri)a.avatar=aa()+"fileapi/"+a.userId+"_s.jpg?fileid="+a.smallImageUri,a.avatarLarge=aa()+"fileapi/"+a.userId+"_b.jpg?fileid="+a.largeImageUri;else{var b=V(a.userId);a.avatar="https://"+ba.domain+ja+b+".png",a.avatarLarge="https://"+ba.domain+ja+b+"-XL.png"}var c=Circuit.Injectors.userInjector;if("function"==typeof c){var d=c(a);return"object"==typeof d&&d.then?d:Promise.resolve(a)}return Promise.resolve(a)}function X(a){switch(a.type){case b.ConversationItemType.TEXT:a.attachments=a.attachments||[],a.externalAttachments=a.externalAttachments||[],"standard"===ca.emoticonMode&&(a.text.content=g.standardizeEmoticon(a.text.content)),e.retrievePrivateDataFromContent(a);break;case b.ConversationItemType.SYSTEM:a.system.affectedParticipants&&(a.system.affectedParticipants=a.system.affectedParticipants.map(function(a){return a.userId}))}var c=Circuit.Injectors.itemInjector;if("function"==typeof c){var d=c(a);return"object"==typeof d&&d.then?d:Promise.resolve(a)}return Promise.resolve(a)}function Y(a){if(!a)return void Promise.resolve();if(a.participants=a.participants.map(function(a){return a.userId}),a.type!==b.ConversationType.DIRECT)if(a.conversationAvatar&&a.conversationAvatar.smallPictureId&&a.conversationAvatar.largePictureId)a.avatar=aa()+"avatar?convId="+a.convId+"&type=small&fileid="+a.conversationAvatar.smallPictureId,a.avatarLarge=aa()+"avatar?convId="+a.convId+"&type=large&fileid="+a.conversationAvatar.largePictureId;else if(a.type===b.ConversationType.OPEN){var c=a.isDraft?"-grey":V(a.convId);a.avatar="https://"+ba.domain+ka+c+".png",a.avatarLarge="https://"+ba.domain+ka+c+"-XL.png"}else a.avatar="https://"+ba.domain+la+".png",a.avatarLarge="https://"+ba.domain+la+"-XL.png";var d,e=Circuit.Injectors.conversationInjector;if("function"==typeof e){var f=e(a);d="object"==typeof f&&f.then?f:Promise.resolve(a)}else d=Promise.resolve(a);if(a.topLevelItem){var g=X(a.topLevelItem);return d.then(g)}return d}function Z(a){d.debug("[SDK] Enqueue "+a.type),ga.push(a)}function $(a){d.debug("[SDK] Dispatch "+a.type),ba.dispatch(a),ha=!1}function _(){if(ga.length&&!ha){ha=!0;try{var a=ga.shift();d.debug("[SDK] Dequeue "+a.type+". Events left in the queue: "+ga.length);var b=[];b.push(a.user?W(a.user):void 0),b.push(a.item?X(a.item):void 0),b.push(a.conversation?Y(a.conversation):void 0),Promise.all(b).then(function(b){b[0]&&(a.user=b[0]),b[1]&&(a.item=b[1]),b[2]&&(a.conversation=b[2]),$(a)})}catch(c){throw ha=!1,c}}}function aa(){return"https://"+ba.domain+"/"}var ba=this,ca=g.shallowCopy(f)||{};ca.domain=ca.domain||"circuitsandbox.net",ca.emoticonMode=ca.emoticonMode||"standard";var da,ea,fa,ga=[],ha=!1;a.BaseEventTarget.call(this);var ia=new a.ClientApiHandler(ca),ja="/content/images/icon-general-default-avatar",ka="/content/images/icon-general-openconvo-avatar",la="/content/images/icon-general-emptyconvo-avatar",ma=["-blue","-green","-orange","-yellow"];return Object.defineProperty(ba,"domain",{value:ca.domain,writable:!1,enumerable:!0,configurable:!1}),ba.logon=function(a,b){return ba.authenticate({email:a,password:b}).then(ba.getLoggedOnUser)},ba.authenticate=function(a){return a&&a.email&&a.password?i(a).then(k):j().then(k)},ba.logout=function(){ia.logout(),ia.disconnect()},ba.setCookie=function(a){ca.cookie=a},ba.isAuthenticated=j,ba.getLoggedOnUser=n,ba.getTelephonyConversationId=x,ba.getSupportConversationId=y,ba.getTenantUsers=o,ba.subscribePresence=R,ba.unsubscribePresence=S,ba.renewToken=T,ba.getUserById=v,ba.getUsersById=w,ba.getUserByEmail=t,ba.getUsersByEmail=u,ba.updateUser=N,ba.changePassword=O,ba.getPresence=Q,ba.setPresence=P,ba.getConversations=p,ba.getConversationById=q,ba.getItemById=r,ba.getConversationItems=s,ba.addTextItem=B,ba.getDirectConversationWithUser=A,ba.addParticipants=G,ba.removeParticipants=H,ba.setFlagItem=I,ba.clearFlagItem=J,ba.likeItem=K,ba.unlikeItem=L,ba.markItemsAsRead=M,ba.createDirectConversation=D,ba.createGroupConversation=E,ba.createOpenConversation=F,ba.startUserSearch=U,ia.on("Conversation.ADD_ITEM",function(a){Z({type:"itemAdded",item:a.item})}),ia.on("Conversation.UPDATE_ITEM",function(a){Z({type:"itemUpdated",item:a.item})}),ia.on("Conversation.CREATE",function(a){Z({type:"conversationCreated",conversation:a.conversation})}),ia.on("Conversation.UPDATE",function(a){Z({type:"conversationUpdated",conversation:a.conversation})}),ia.on("User.USER_PRESENCE_CHANGE",function(a){Z({type:"userPresenceChanged",presenceState:a.newState})}),ia.on("User.USER_UPDATED",function(a){Z({type:"userUpdated",user:a.user})}),ia.addEventListener("connectionStateChange",function(a){Z({type:"connectionStateChanged",state:a.newState})}),ia.addEventListener("reconnectFailed",function(){Z({type:"reconnectFailed"})}),ia.on("User.USER_SETTING_UPDATED",function(a){Z({type:"userSettingsUpdated",settings:a.settings})}),ia.on("Search.BASIC_SEARCH_RESULT",function(a){Z({type:"basicSearchResults",data:a})}),ia.on("System.MAINTENANCE",function(a){Z({type:"systemMaintenance",data:a})}),ia.on("User.USER_DELETED",function(a){Z({type:"userDeleted",data:a})}),ia.on("Conversation.DELETE",function(a){Z({type:"conversationDeleted",convId:a.convId})}),window.setInterval(_,20),ba},a.Client.prototype.name="Client",a.isCompatible=function(){var a=g.getBrowserInfo();return"chrome"===a.type&&"4"===a.version[0]},a}(Circuit);/**
@license
Copyright (c) 2015 Unify. All rights reserved.

Allow node app to define it's own logger for the node SDK
*/

var Circuit = (function (circuit) {
    'use strict';

    circuit.setLogger = function setLogger(appLogger) {
        appLogger = appLogger || {};
        var logDebug = appLogger.debug || appLogger.log || function () {};
        var logInfo = appLogger.info || logDebug;
        var logWarning = appLogger.warn || appLogger.warning || logInfo;
        var logError = appLogger.error || logWarning;

        circuit.logger.debug = function () {
            logDebug.apply(appLogger, Array.prototype.slice.apply(arguments));
        };
        circuit.logger.info = function () {
            logInfo.apply(appLogger, Array.prototype.slice.apply(arguments));
        };
        circuit.logger.warning = function () {
            logWarning.apply(appLogger, Array.prototype.slice.apply(arguments));
        };
        circuit.logger.warn = function () {
            logWarning.apply(appLogger, Array.prototype.slice.apply(arguments));
        };
        circuit.logger.error = function (error, obj) {
            var args = [(error && error.stack) || error];
            obj = (obj && obj.stack) || obj;
            if (obj) {
                args.push(obj);
            }
            logError.apply(appLogger, args);
        };
        circuit.logger.msgSend = function () {
            logInfo.apply(appLogger, Array.prototype.slice.apply(arguments));
        };
        circuit.logger.msgRcvd = function () {
            logInfo.apply(appLogger, Array.prototype.slice.apply(arguments));
        };
    };

    return circuit;
})(Circuit || {});/**
@license
Copyright (c) 2015 Unify. All rights reserved.

Cookie management for node SDK
*/

var NodeSDK = {};

(function () {
    'use strict';
    NodeSDK.compatible = false; // if true allow signon to /login && /sdklogin
    NodeSDK.UserAgent = 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2125.122 Safari/537.36';
    NodeSDK.rejectUnauthorized = false; // reject connection on certification validation failure
}());

/**
@license
Copyright (c) 2015 Unify. All rights reserved.

Websocket for node SDK
*/

/*global Circuit, require*/
/*exported WebSocket */
var NodeWebSocket = require('ws');

function WebSocket(target, cookie) {
    'use strict';

    var logger = Circuit.logger;

    var wsOptions = {headers: {Cookie: cookie}, rejectUnauthorized: false};
    logger.debug('[WebSocket]: Initiated websocket with ' + JSON.stringify(wsOptions));
    return new NodeWebSocket(target, wsOptions);
}/**
@license
Copyright (c) 2015 Unify. All rights reserved.

XMLHttpRequest for node SDK
*/

/*global Circuit, require, NodeSDK, process*/
/*exported XMLHttpRequest */
var https = require('https');
var nodeUrl = require('url');

var XMLHttpRequest = function (config) {
    'use strict';

    var _logger = Circuit.logger;
    var _self = this;

    _self.httpReqOptions = null;
    _self.withCredentials = null;
    _self.onload = function () {};
    _self.onerror = function () {};
    _self.login = false;
    _self.config = config;

    this.setRequestHeader = function (header, value) {
        _logger.debug('[XMLHttpRequest]: setRequestHeader ' + header + ':' + value);
        this.httpReqOptions.headers[header] = value;
    };

    this.setAuthCookie = function (res) {
        _self.config.cookie = '';
        var str = res.headers['set-cookie'].toString();
        var re = null, found = false;
        re = /.*(connect\.sess=.*?);.*/i;
        found = str.match(re);
        if (found) {
            _self.config.cookie += found[1];
        } else {
            _logger.error('[XMLHttpRequest]: setAuthCookie connect.sess not found in set-cookie');
            process.exit(1);
        }
        _logger.debug('[XMLHttpRequest]: setAuthCookie ' + JSON.stringify(_self.config.cookie, null, 2));
    };

    this.open = function (method, url, async) {
        _logger.debug('[XMLHttpRequest]: open ' + method + ' ' +  url + ' ' + async);
        var parts = nodeUrl.parse(url);
        _logger.debug(JSON.stringify(parts, null, 2));

        this.httpReqOptions = {
            host: parts.hostname,
            port: (parts.port) ? parts.port : '443',
            path: parts.path,
            method: method,
            headers: {
                'User-Agent': NodeSDK.UserAgent
            },
            rejectUnauthorized: NodeSDK.rejectUnauthorized
        };

        if (parts.path !== '/sdklogin') {
            this.setRequestHeader('Cookie', _self.config.cookie);
            this.login = false;
        } else {
            this.login = true;
        }
    };

    this.send = function (data) {
        _logger.debug('[XMLHttpRequest]: send');
        var xhr = this;
        _logger.debug('[XMLHttpRequest]: ' + JSON.stringify(this.httpReqOptions, null, 2));

        var req = https.request(this.httpReqOptions, function (res) {
            _logger.debug('[XMLHttpRequest]: response code ' + res.statusCode);
            _logger.debug('[XMLHttpRequest]: response headers ' + JSON.stringify(res.headers, null, 2));

            xhr.status = res.statusCode;

            if (res.statusCode !== 200 && res.statusCode !== 302) {
                _logger.error('[XMLHttpRequest]: response with status code error');
                xhr.onerror();
                return;
            }

            //to support testing login against /login URL in compatibility mode
            if (NodeSDK.compatible && res.statusCode === 302) {
                xhr.status = 200;
            }

            if (xhr.login) {
                xhr.setAuthCookie(res);
            }

            res.setEncoding('utf8');

            res.on('data', function (data) {
                _logger.debug('[XMLHttpRequest]: ready to call onload with ' + JSON.stringify(data, null, 2));
                xhr.responseText = data;
                xhr.onload();
            });

            res.on('error', function (e) {
                _logger.error('[XMLHttpRequest]: result error ' + JSON.stringify(e, null, 2));
                xhr.onerror();
            });

        });

        if (arguments.length > 0) {
            _logger.debug('[XMLHttpRequest]: sending data');
            req.write(data);
        }

        req.on('error', function (e) {
            _logger.error('[XMLHttpRequest]: request error ' + JSON.stringify(e, null, 2));
            xhr.onerror();
        });

        req.end();
    };
};/**
@license
Copyright (c) 2015 Unify. All rights reserved.

exports for node SDK
*/

/*global Circuit, exports:true, module*/
module.exports = exports = Circuit;
